<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Streaming - Web Player</title>
    
    <!-- ================= CSS UNIFICADO ================= -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        // ========== SISTEMA ANTI-REATIVA√á√ÉO DOS CONTROLES ==========
        function setupClapprControlSuppressor() {
            const clapprContainer = document.getElementById('clappr');
            if (!clapprContainer) return;

            let suppressorActive = false;
            let suppressorTimeout;

            // Ativa o suppressor ap√≥s 5 segundos de reprodu√ß√£o
            const activateSuppressor = () => {
                suppressorActive = true;
                console.log('üîí Suppressor de controles ativado');
                
                // For√ßa esconder controles a cada 2 segundos
                const forceHideInterval = setInterval(() => {
                    if (suppressorActive && isPlaying) {
                        const clapprContainer = document.getElementById('clappr');
                        if (clapprContainer) {
                            clapprContainer.classList.add('clappr-controls-hidden', 'auto-hide-controls');
                            
                            // For√ßa esconder elementos que podem ter reaparecido
                            const visibleControls = clapprContainer.querySelectorAll('.media-control:not(.hide), [data-media-control]:not(.hide)');
                            visibleControls.forEach(el => {
                                el.style.opacity = '0';
                                el.style.visibility = 'hidden';
                                el.style.display = 'none';
                                el.classList.add('hide');
                            });
                        }
                    } else {
                        clearInterval(forceHideInterval);
                    }
                }, 2000);

                // Desativa suppressor ap√≥s 60 segundos
                setTimeout(() => {
                    suppressorActive = false;
                    clearInterval(forceHideInterval);
                    console.log('üîì Suppressor de controles desativado');
                }, 60000);
            };

            // Intercepta eventos que podem reativar controles
            const interceptEvents = ['mousemove', 'mouseenter', 'mouseover', 'click', 'touchstart', 'touchmove'];
            
            interceptEvents.forEach(eventType => {
                clapprContainer.addEventListener(eventType, (e) => {
                    if (suppressorActive && isPlaying) {
                        // Permite o evento, mas for√ßa esconder controles logo ap√≥s
                        setTimeout(() => {
                            hidePlayerControls();
                        }, 100);
                    }
                }, { passive: true });
            });

            // Ativa o suppressor ap√≥s 5 segundos
            setTimeout(activateSuppressor, 5000);
        }

        // ========== MONITOR PERSISTENTE DE CONTROLES (√öLTIMA LINHA DE DEFESA) ==========
        function startPersistentControlMonitor() {
            let monitorActive = false;
            let monitorInterval;

            const startMonitoring = () => {
                if (monitorActive) return;
                
                monitorActive = true;
                console.log('üëÅÔ∏è Monitor persistente de controles iniciado');

                monitorInterval = setInterval(() => {
                    if (currentPlayerType === 'clappr' && isPlaying) {
                        // Lista de todos os poss√≠veis seletores de controles do Clappr
                        const allControlSelectors = [
                            '#clappr .media-control',
                            '#clappr [data-media-control]',
                            '#clappr .media-control-background',
                            '#clappr .media-control-layer', 
                            '#clappr .media-control-center-panel',
                            '#clappr .media-control-left-panel',
                            '#clappr .media-control-right-panel',
                            '#clappr .media-control-bar',
                            '#clappr .play-pause',
                            '#clappr .stop-button',
                            '#clappr .volume-icon',
                            '#clappr .volume-bar',
                            '#clappr .seekbar',
                            '#clappr .progress-bar',
                            '#clappr .time-indicator',
                            '#clappr .fullscreen',
                            '#clappr .drawer-icon',
                            '#clappr .live-indicator',
                            '.player-wrapper .media-control',
                            '.player-wrapper [data-media-control]'
                        ];

                        // Verifica cada seletor e for√ßa esconder
                        allControlSelectors.forEach(selector => {
                            const elements = document.querySelectorAll(selector);
                            elements.forEach(el => {
                                // S√≥ atua se o elemento estiver vis√≠vel
                                if (el && (el.style.display !== 'none' || el.style.opacity !== '0' || el.style.visibility !== 'hidden')) {
                                    el.style.setProperty('opacity', '0', 'important');
                                    el.style.setProperty('visibility', 'hidden', 'important');
                                    el.style.setProperty('display', 'none', 'important');
                                    el.style.setProperty('pointer-events', 'none', 'important');
                                    el.classList.add('hide');
                                    
                                    // Adiciona classes CSS que for√ßam esconder
                                    const parent = el.closest('#clappr, .player-wrapper');
                                    if (parent) {
                                        parent.classList.add('clappr-controls-hidden', 'auto-hide-controls');
                                    }
                                }
                            });
                        });
                    }
                }, 1500); // Verifica a cada 1.5 segundos

                // Para o monitor ap√≥s 2 minutos
                setTimeout(() => {
                    monitorActive = false;
                    if (monitorInterval) {
                        clearInterval(monitorInterval);
                        console.log('üëÅÔ∏è Monitor persistente finalizado');
                    }
                }, 120000);
            };

            // Inicia monitor quando o player come√ßar a reproduzir
            if (currentPlayerType === 'clappr' && isPlaying) {
                setTimeout(startMonitoring, 3000);
            }
        }
        
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            position: fixed;
            margin-top: 0px !important;
            width: 100%;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            overflow-x: hidden;
            padding: 0;
        }

        /* Splash Screen Styles */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3a 50%, #2d2d5f 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            animation: splashFadeOut 1s ease-in-out 3s forwards;
        }

        .splash-logo {
            font-size: 4rem;
            font-weight: bold;
            color: #ff6b35;
            text-shadow: 0 0 20px rgba(255, 107, 53, 0.8);
            margin-bottom: 20px;
            animation: logoGlow 2s ease-in-out infinite alternate;
        }

        .splash-subtitle {
            font-size: 1.5rem;
            color: #fff;
            margin-bottom: 40px;
            opacity: 0;
            animation: fadeInUp 1s ease-out 0.5s forwards;
        }

        .splash-developer {
            font-size: 1rem;
            color: #ff6b35;
            margin-bottom: 30px;
            opacity: 0;
            animation: fadeInUp 1s ease-out 1s forwards;
        }

        .loading-container {
            width: 300px;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .loading-bar {
            height: 100%;
            background: linear-gradient(90deg, #ff6b35, #ffaa00);
            border-radius: 3px;
            width: 0%;
            animation: loadingProgress 3s ease-in-out forwards;
            box-shadow: 0 0 10px rgba(255, 107, 53, 0.6);
        }

        .loading-text {
            font-size: 0.9rem;
            color: #ccc;
            opacity: 0;
            animation: fadeInUp 1s ease-out 1.5s forwards;
        }

        .tv-icon {
            font-size: 5rem;
            margin-bottom: 20px;
            opacity: 0;
            animation: tvIconBounce 2s ease-out 0.2s forwards;
        }

        .signal-bars {
            display: flex;
            gap: 5px;
            margin-top: 20px;
            opacity: 0;
            animation: fadeInUp 1s ease-out 2s forwards;
        }

        .signal-bar {
            width: 8px;
            height: 30px;
            background: #ff6b35;
            border-radius: 4px;
            animation: signalPulse 1.5s ease-in-out infinite;
        }

        .signal-bar:nth-child(2) { animation-delay: 0.2s; }
        .signal-bar:nth-child(3) { animation-delay: 0.4s; }
        .signal-bar:nth-child(4) { animation-delay: 0.6s; }
        .signal-bar:nth-child(5) { animation-delay: 0.8s; }

        /* Canal Number Display */
        .channel-number-display {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 2rem;
            font-weight: bold;
            color: #ff6b35;
            display: none;
            z-index: 999999;
            border: 2px solid #ff6b35;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }

        /* Fullscreen Info Panel */
        .fullscreen-info {
            position: fixed !important;
            top: 20px !important;
            left: 20px !important;
            right: 20px !important;
            background: rgba(0, 0, 0, 0.95) !important;
            padding: 20px !important;
            border-radius: 10px !important;
            color: white !important;
            display: none !important;
            z-index: 2147483647 !important;
            border: 2px solid #ff6b35 !important;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.8) !important;
            backdrop-filter: blur(10px) !important;
            -webkit-backdrop-filter: blur(10px) !important;
        }

        .fullscreen-info h3 {
            color: #ff6b35 !important;
            margin-bottom: 10px !important;
            font-size: 1.3rem !important;
        }

        .fullscreen-info .info-row {
            display: flex !important;
            justify-content: space-between !important;
            margin-bottom: 8px !important;
            font-size: 1rem !important;
        }

        .fullscreen-info .info-row span:first-child {
            font-weight: bold !important;
        }

        /* Audio Visualizer */
        .audio-visualizer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a3a 0%, #2d2d5f 50%, #1e3c72 100%);
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .audio-visualizer.active {
            display: flex;
        }

        .audio-info {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            z-index: 10;
        }

        .audio-info h2 {
            color: #ff6b35;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(255, 107, 53, 0.8);
            animation: none !important;
            transform: none !important;
        }

        .audio-info p {
            color: #ccc;
            font-size: 1.2rem;
            animation: none !important;
            transform: none !important;
        }

        .equalizer {
            display: flex;
            align-items: end;
            gap: 4px;
            height: 150px;
            margin-bottom: 30px;
        }

        .equalizer-bar {
            width: 12px;
            background: linear-gradient(to top, #ff6b35, #ffaa00, #ff6b35);
            border-radius: 6px;
            min-height: 10px;
            transition: height 0.1s ease;
            box-shadow: 0 0 10px rgba(255, 107, 53, 0.6);
        }

        .audio-controls {
            text-align: center;
            color: #ccc;
            position: relative;
            z-index: 10;
        }

        .audio-controls .playing-indicator {
            font-size: 1.5rem;
            animation: gentlePulse 3s infinite;
        }

        @keyframes gentlePulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        /* Main Content - Hidden Initially */
        .main-app {
            opacity: 0;
            animation: mainAppFadeIn 1s ease-out 4s forwards;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        /* Splash Animations */
        @keyframes splashFadeOut {
            to {
                opacity: 0;
                visibility: hidden;
            }
        }

        @keyframes logoGlow {
            0% {
                text-shadow: 0 0 20px rgba(255, 107, 53, 0.8), 0 0 40px rgba(255, 107, 53, 0.4);
                transform: scale(1);
            }
            100% {
                text-shadow: 0 0 30px rgba(255, 107, 53, 1), 0 0 60px rgba(255, 107, 53, 0.6);
                transform: scale(1.05);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes tvIconBounce {
            0% {
                opacity: 0;
                transform: translateY(-50px) scale(0.5);
            }
            60% {
                opacity: 1;
                transform: translateY(10px) scale(1.1);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes loadingProgress {
            0% { width: 0%; }
            20% { width: 30%; }
            50% { width: 60%; }
            80% { width: 85%; }
            100% { width: 100%; }
        }

        @keyframes signalPulse {
            0%, 100% {
                height: 10px;
                opacity: 0.4;
            }
            50% {
                height: 30px;
                opacity: 1;
            }
        }

        @keyframes mainAppFadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: rgba(0, 0, 0, 0.8);
            padding: 20px 0;
            text-align: center;
            border-bottom: 3px solid #ff6b35;
            flex-shrink: 0;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .header .developer {
            font-size: 1rem;
            color: #ff6b35;
            font-weight: 300;
        }

        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 350px;
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            overflow-y: auto;
            border-right: 2px solid #333;
            flex-shrink: 0;
        }

        .sidebar h2 {
            margin-bottom: 20px;
            color: #ff6b35;
            font-size: 1.5rem;
            text-align: center;
        }

        .channel-list {
            list-style: none;
        }

        .channel-item {
            background: rgba(255, 255, 255, 0.1);
            margin-bottom: 10px;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            display: flex;
            align-items: center;
            font-size: 1.1rem;
        }

        .channel-item:hover,
        .channel-item:focus,
        .channel-item.focused {
            background: #ff6b35;
            transform: translateX(10px);
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
            border-color: #fff;
            outline: none;
        }

        .channel-item.active {
            background: #28a745;
            border-color: #fff;
        }

        .channel-number {
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 20px;
            margin-right: 15px;
            font-weight: bold;
            min-width: 40px;
            text-align: center;
            font-size: 0.9rem;
        }

        .main-content {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Estilos do Player */
        #clappr, #alternativePlayer { 
            width: 100%;
            height: 100%;
            position: relative; 
            min-height: 340px; 
            margin-bottom: 0px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        #clappr > div, #alternativePlayer > div { 
            width: 100%;
            height: 100%;
            position: absolute;
            border-radius: 10px;
        }
        
        .video-container {
            position: relative;
            width: 100%;
            flex-grow: 1;
            background: #000;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
        }

        .video-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            background: linear-gradient(45deg, #333, #555);
            font-size: 1.5rem;
            color: #ccc;
        }

        .controls {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-shrink: 0;
        }

        .control-btn {
            background: #ff6b35;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .control-btn:hover,
        .control-btn:focus {
            background: #e55a2b;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.5);
            outline: 2px solid white;
        }

        .info-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #ff6b35;
            display: none;
            z-index: 1000;
            max-width: 500px;
            text-align: center;
        }

        .info-panel h3 {
            color: #ff6b35;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .remote-instructions {
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-size: 0.9rem;
            line-height: 1.5;
            flex-shrink: 0;
        }

        .remote-instructions h4 {
            color: #ff6b35;
            margin-bottom: 10px;
        }

        .key-hint {
            display: inline-block;
            background: #333;
            padding: 3px 8px;
            border-radius: 4px;
            margin: 2px;
            font-family: monospace;
        }

        /* Indicador de scroll */
        .scroll-indicator {
            text-align: center;
            padding: 5px;
            font-size: 0.8rem;
            color: #ff6b35;
            animation: pulse 2s infinite;
        }
        
        /* Melhora visibilidade dos controles em TVs */
        .smart-tv .channel-item:focus {
            outline: 3px solid #ff6b35;
            outline-offset: 2px;
        }
        
        .smart-tv .control-btn:focus {
            outline: 3px solid white;
            outline-offset: 2px;
            transform: scale(1.1);
        }

        /* Anima√ß√µes */
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }

        .channel-item.active {
            animation: pulse 2s infinite;
        }

        /* Scrollbar personalizada */
        .sidebar::-webkit-scrollbar {
            width: 8px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: #ff6b35;
            border-radius: 4px;
        }

        /* Loading spinner */
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #ff6b35;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsividade Aprimorada */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .header .developer {
                font-size: 0.8rem;
            }
            
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: 150px;
                flex-shrink: 0;
                padding: 10px;
            }
            
            .sidebar h2 {
                font-size: 1.2rem;
                margin-bottom: 10px;
            }
            
            .channel-list {
                display: flex;
                gap: 10px;
                overflow-x: auto;
                padding-bottom: 10px;
                -webkit-overflow-scrolling: touch;
                scroll-snap-type: x mandatory;
            }
            
            .channel-item {
                min-width: 120px;
                flex-shrink: 0;
                padding: 10px;
                font-size: 0.9rem;
                scroll-snap-align: start;
            }
            
            .channel-number {
                font-size: 0.8rem;
                padding: 3px 8px;
            }
            
            .main-content {
                padding: 10px;
            }
            
            .video-container {
                border-radius: 5px;
            }
            
            .controls {
                flex-wrap: wrap;
                gap: 10px;
                margin-top: 10px;
            }
            
            .control-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
                flex: 1;
                min-width: 100px;
            }
            
            .remote-instructions {
                display: none;
            }
            
            .fullscreen-btn {
                background: #28a745 !important;
                flex: none;
                width: 100%;
                margin-top: 10px;
            }

            /* Esconde bot√£o INFO em dispositivos m√≥veis */
            .info-btn {
                display: none !important;
            }
        }
        
        @media (max-width: 480px) {
            .header {
                padding: 10px 0;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .channel-item {
                min-width: 100px;
                padding: 8px;
            }
            
            .control-btn {
                padding: 12px;
                font-size: 0.8rem;
            }

            /* Esconde bot√£o INFO em telas muito pequenas tamb√©m */
            .info-btn {
                display: none !important;
            }
        }
        
        @media (hover: none) and (pointer: coarse) {
            .channel-item:active {
                background: #ff6b35;
                transform: scale(0.98);
            }
            
            .control-btn:active {
                transform: scale(0.95);
            }
            
            .channel-item,
            .control-btn {
                min-height: 44px;
            }

            /* Esconde bot√£o INFO em dispositivos touch */
            .info-btn {
                display: none !important;
            }
        }
        
        @supports (-webkit-touch-callout: none) {
            .sidebar {
                -webkit-overflow-scrolling: touch;
            }
            
            input, select, textarea {
                font-size: 16px;
            }

            /* Esconde bot√£o INFO no iOS */
            .info-btn {
                display: none !important;
            }
        }
        
        @media (min-width: 1920px) {
            .header h1 {
                font-size: 3.5rem;
            }
            
            .sidebar {
                width: 450px;
            }
            
            .channel-item {
                font-size: 1.3rem;
                padding: 20px;
            }
            
            .control-btn {
                font-size: 1.2rem;
                padding: 15px 35px;
            }
        }

        /* ========== RESPONSIVIDADE APRIMORADA PARA MOBILE LANDSCAPE ========== */
        @media (max-width: 768px) and (orientation: landscape) {
            html, body {
                height: 100%;
                overflow-x: hidden;
                overflow-y: auto;
                position: relative;
            }

            .header {
                display: none; /* Remove header em landscape */
            }

            .container {
                flex-direction: row;
                flex-wrap: nowrap;
                height: 100vh;
                padding: 0;
                margin: 0;
            }

            .sidebar {
                width: 200px;
                height: 100%;
                overflow-y: auto;
                overflow-x: hidden;
                flex-shrink: 0;
                padding: 8px;
                border-right: 2px solid #222;
                background: rgba(0, 0, 0, 0.95);
            }

            .sidebar h2 {
                font-size: 0.9rem;
                margin-bottom: 8px;
                text-align: center;
            }

            .channel-list {
                flex-direction: column;
                gap: 5px;
                overflow-y: auto;
                overflow-x: hidden;
                padding-bottom: 8px;
            }

            .channel-item {
                display: block;
                min-width: auto;
                max-width: none;
                padding: 8px;
                font-size: 0.8rem;
                margin-bottom: 3px;
            }

            .channel-number {
                font-size: 0.7rem;
                padding: 2px 6px;
            }

            /* ========== PLAYER CENTRALIZADO E ISOLADO ========== */
            .main-content {
                flex: 1;
                padding: 20px 40px; /* Aumenta padding lateral */
                display: flex;
                flex-direction: column;
                justify-content: center; /* Centraliza verticalmente */
                align-items: center; /* Centraliza horizontalmente */
                background: rgba(0, 0, 0, 0.8);
                position: relative;
                min-height: calc(100vh - 100px); /* Garante altura m√≠nima */
            }

            .video-container {
                width: 85%; /* Reduz largura para criar espa√ßos laterais */
                height: 70%; /* Reduz altura para criar espa√ßos superior/inferior */
                max-width: 600px; /* Largura m√°xima */
                max-height: 400px; /* Altura m√°xima */
                min-height: 280px; /* Altura m√≠nima */
                margin: auto; /* Centraliza o container */
                border-radius: 10px;
                box-shadow: 0 10px 40px rgba(0, 0, 0, 0.7); /* Sombra mais pronunciada */
                border: 2px solid rgba(255, 107, 53, 0.3); /* Borda sutil */
                background: #000;
                position: relative;
                
                /* Espa√ßamento adicional */
                margin-top: 40px; /* Espa√ßo superior */
                margin-bottom: 40px; /* Espa√ßo inferior */
                margin-left: 30px; /* Espa√ßo esquerda */
                margin-right: 30px; /* Espa√ßo direita */
            }

            /* ========== CONTROLES CENTRALIZADOS ========== */
            .controls {
                position: fixed;
                bottom: 10px;
                left: 50%;
                transform: translateX(-50%);
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 8px;
                background: rgba(0, 0, 0, 0.9);
                padding: 12px 20px;
                border-radius: 25px;
                z-index: 1000;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.8);
                border: 1px solid rgba(255, 107, 53, 0.3);
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
            }

            .control-btn {
                flex: 1 1 auto;
                min-width: 70px;
                max-width: 100px;
                padding: 8px 12px;
                font-size: 0.75rem;
                border-radius: 20px;
                margin: 2px;
            }

            /* Esconde bot√£o INFO em mobile landscape */
            .info-btn {
                display: none !important;
            }

            .fullscreen-btn {
                width: auto !important;
                font-size: 0.75rem !important;
                margin-top: 0 !important;
                background: #ff6b35 !important;
            }

            .remote-instructions {
                display: none;
            }

            /* Adiciona espa√ßamento no corpo para n√£o conflitar com controles fixos */
            .main-content {
                padding-bottom: 100px;
            }

            /* ========== OVERLAY DE CANAL MAIS VIS√çVEL ========== */
            #channel-name-overlay {
                position: absolute;
                top: 15px;
                left: 15px;
                background: rgba(0, 0, 0, 0.8);
                padding: 8px 15px;
                border-radius: 20px;
                border: 1px solid rgba(255, 107, 53, 0.5);
                backdrop-filter: blur(5px);
                -webkit-backdrop-filter: blur(5px);
            }

            /* ========== PLACEHOLDER RESPONSIVO ========== */
            .video-placeholder {
                padding: 20px;
                text-align: center;
                font-size: 1rem;
            }

            /* ========== √ÅUDIO VISUALIZER RESPONSIVO ========== */
            .audio-visualizer {
                padding: 20px;
            }

            .audio-info h2 {
                font-size: 1.8rem;
            }

            .audio-info p {
                font-size: 1rem;
            }

            .equalizer {
                height: 100px;
                margin-bottom: 20px;
            }
        }

        /* ========== FOR√áAR ORIENTA√á√ÉO VERTICAL EM FULLSCREEN (MOBILE) ========== */
        @media (max-width: 768px) {
            .mobile-device.force-portrait {
                transform: rotate(90deg) !important;
                transform-origin: center center !important;
                width: 100vh !important;
                height: 100vw !important;
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                z-index: 9999999 !important;
            }

            /* Estilo especial para fullscreen em mobile */
            .mobile-fullscreen-active {
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                z-index: 9999999 !important;
                background: #000 !important;
            }

            .mobile-fullscreen-active .video-container {
                width: 100% !important;
                height: 100% !important;
                max-width: none !important;
                max-height: none !important;
                margin: 0 !important;
                border-radius: 0 !important;
                border: none !important;
            }

            .mobile-fullscreen-active .controls {
                position: fixed !important;
                bottom: 20px !important;
                left: 50% !important;
                transform: translateX(-50%) !important;
                z-index: 10000000 !important;
            }

            /* Esconde sidebar e outros elementos em fullscreen mobile */
            .mobile-fullscreen-active .sidebar,
            .mobile-fullscreen-active .header {
                display: none !important;
            }
        }

        @media (min-width: 768px) {
            .orientation-message {
                display: none !important;
            }
        }

        /* Overlay do nome do canal */
        #channel-name-overlay {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 99999;
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.2rem;
            font-weight: bold;
            text-shadow: 1px 1px 3px black;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        /* CSS para esconder controles do Clappr de forma persistente */
        .clappr-controls-hidden .media-control,
        .clappr-controls-hidden .media-control-background,
        .clappr-controls-hidden .media-control-layer,
        .clappr-controls-hidden .media-control-center-panel,
        .clappr-controls-hidden .media-control-left-panel,
        .clappr-controls-hidden .media-control-right-panel,
        .clappr-controls-hidden .media-control-bar,
        .clappr-controls-hidden .media-control-bar-container,
        .clappr-controls-hidden [data-media-control],
        .clappr-controls-hidden .play-pause,
        .clappr-controls-hidden .stop-button,
        .clappr-controls-hidden .live-indicator,
        .clappr-controls-hidden .volume-icon,
        .clappr-controls-hidden .volume-bar,
        .clappr-controls-hidden .progress-bar,
        .clappr-controls-hidden .seekbar,
        .clappr-controls-hidden .time-indicator,
        .clappr-controls-hidden .fullscreen,
        .clappr-controls-hidden .drawer-icon,
        .clappr-controls-hidden .level-selector {
            opacity: 0 !important;
            visibility: hidden !important;
            display: none !important;
            pointer-events: none !important;
            transition: opacity 0.8s ease !important;
        }

        /* For√ßa esconder todos os controles do Clappr ap√≥s carregamento */
        #clappr .media-control.hide,
        #clappr .media-control-background.hide,
        #clappr .media-control-layer.hide,
        #clappr [data-media-control].hide {
            opacity: 0 !important;
            visibility: hidden !important;
            display: none !important;
            pointer-events: none !important;
        }

        /* Esconde controles espec√≠ficos do Clappr */
        #clappr .media-control-bar,
        #clappr .media-control-center-panel,
        #clappr .media-control-left-panel,
        #clappr .media-control-right-panel {
            transition: opacity 1s ease;
        }

        /* Classe para aplicar quando queremos esconder */
        .auto-hide-controls .media-control,
        .auto-hide-controls [data-media-control] {
            opacity: 0 !important;
            transition: opacity 1s ease !important;
        }

        .auto-hide-controls .media-control.hide,
        .auto-hide-controls [data-media-control].hide {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div class="splash-screen" id="splashScreen">
        <div class="tv-icon">üì∫</div>
        <div class="splash-logo">Stream Play</div>
        <div class="splash-subtitle">Sua TV na web</div>
        <div class="splash-developer">Desenvolvido por Andr√© Miranda</div>
        
        <div class="loading-container">
            <div class="loading-bar"></div>
        </div>
        
        <div class="loading-text">Carregando canais...</div>
        
        <div class="signal-bars">
            <div class="signal-bar"></div>
            <div class="signal-bar"></div>
            <div class="signal-bar"></div>
            <div class="signal-bar"></div>
            <div class="signal-bar"></div>
        </div>
    </div>

    <!-- Main Application -->
    <div class="main-app" id="mainApp">
        <div class="header">
            <h1>Stream Play</h1>
            <div class="developer">Desenvolvido por: Andr√© Miranda</div>
        </div>

        <!-- Display de n√∫mero do canal -->
        <div class="channel-number-display" id="channelNumberDisplay"></div>

        <!-- Info panel para tela cheia -->
        <div class="fullscreen-info" id="fullscreenInfo">
            <h3>üì∫ Informa√ß√µes do Canal</h3>
            <div class="info-row">
                <span>Canal:</span>
                <span id="fsChannelName">-</span>
            </div>
            <div class="info-row">
                <span>N√∫mero:</span>
                <span id="fsChannelNumber">-</span>
            </div>
            <div class="info-row">
                <span>Status:</span>
                <span id="fsChannelStatus">-</span>
            </div>
            <div class="info-row">
                <span>Tipo:</span>
                <span id="fsChannelType">-</span>
            </div>
        </div>

        <div class="container">
            <div class="sidebar">
                <h2>üì∫ CANAIS</h2>
                <ul class="channel-list" id="channelList">
                    <!-- Canais ser√£o carregados via JavaScript -->
                </ul>
            </div>

            <div class="main-content">
                <div class="video-container">
                    <div class="video-placeholder" id="videoPlaceholder">
                        Selecione um canal para come√ßar a assistir
                    </div>
                    <div id="clappr" style="display: none;"></div>
                    <div id="alternativePlayer" style="display: none;"></div>
                    
                    <!-- Audio Visualizer -->
                    <div class="audio-visualizer" id="audioVisualizer">
                        <div class="audio-info">
                            <h2 id="audioChannelName">R√°dio</h2>
                            <p id="audioChannelDesc">Streaming de √Åudio</p>
                        </div>
                        
                        <div class="equalizer" id="equalizer">
                            <!-- Barras do equalizador ser√£o geradas via JS -->
                        </div>
                        
                        <div class="audio-controls">
                            <div class="playing-indicator">üéµ Tocando Agora</div>
                        </div>
                    </div>
                </div>

                <div class="controls">
                    <button class="control-btn" onclick="vibrateFeedback(); previousChannel()">‚èÆÔ∏è Anterior</button>
                    <button class="control-btn" onclick="vibrateFeedback(); togglePlayPause()">‚èØÔ∏è Play/Pause</button>
                    <button class="control-btn" onclick="vibrateFeedback(); nextChannel()">‚è≠Ô∏è Pr√≥ximo</button>
                    <button class="control-btn info-btn" onclick="vibrateFeedback(); showInfo()">‚ÑπÔ∏è Info</button>
                    <button class="control-btn fullscreen-btn" onclick="vibrateFeedback(); toggleFullscreen()">üì∫ Tela Cheia</button>
                </div>

                <div class="remote-instructions">
                    <h4>üéÆ Controle Remoto/Teclado:</h4>
                    <center><span class="key-hint">‚Üë‚Üì</span> Canais &nbsp;
                    <span class="key-hint">Enter</span> Selecionar &nbsp;
                    <span class="key-hint">Espa√ßo</span> Play/Pause &nbsp;
                    <span class="key-hint">‚Üê‚Üí</span> Ant/Prox &nbsp;
                    <span class="key-hint">F</span> Tela Cheia &nbsp;
                    <span class="key-hint">i</span> Informa√ß√µes &nbsp;
                    <span class="key-hint">0-9</span> Ir para canal &nbsp;
                    <span class="key-hint">Esc</span> Sair</center>
                </div>
            </div>
        </div>

        <div class="info-panel" id="infoPanel">
            <h3>üì∫ Informa√ß√µes do Canal</h3>
            <div id="channelInfo">
                <p><strong>Canal:</strong> <span id="currentChannelName">-</span></p>
                <p><strong>N√∫mero:</strong> <span id="currentChannelNumber">-</span></p>
                <p><strong>Status:</strong> <span id="channelStatus">Carregando...</span></p>
                <p><strong>Tipo:</strong> <span id="channelType">-</span></p>
            </div>
            <button class="control-btn" onclick="hideInfo()" style="margin-top: 15px;">Fechar</button>
        </div>
    </div>

    <!-- Clappr Player -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@clappr/player@0.4.0/dist/clappr.min.js"></script>
    
    <!-- ================= JAVASCRIPT UNIFICADO ================= -->
    <script>
        // ========== CONFIGURA√á√ïES GLOBAIS ==========
        const SPLASH_SOUND_URL = 'https://roku-streaming-server.onrender.com/vinheta-plim-plim-hd.mp3';
        const YOUTUBE_API_KEY = 'AIzaSyCNL4lsOgLRiRj1jc_5c0OVTK_E85ChVMc';

        // ========== DETEC√á√ÉO DE DISPOSITIVOS ==========
        const deviceInfo = {
            isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),
            isIOS: /iPhone|iPad|iPod/i.test(navigator.userAgent),
            isAndroid: /Android/i.test(navigator.userAgent),
            isTV: /SmartTV|WebOS|Tizen|NetCast|CrKey|Android TV|Roku|BRAVIA|DTV|Viera|GoogleTV|AppleTV|AFT/i.test(navigator.userAgent),
            isRoku: /Roku/i.test(navigator.userAgent),
            isTizen: /Tizen/i.test(navigator.userAgent),
            isWebOS: /WebOS|Web0S/i.test(navigator.userAgent),
            isTouchDevice: ('ontouchstart' in window) || (navigator.maxTouchPoints > 0)
        };

        // ========== CONFIGURA√á√ÉO DOS CANAIS ==========
        const channels = [
            { number: 1, name: "TV Cultura", url: "https://5b33b873179a2.streamlock.net:1443/live/livestream/playlist.m3u8", type: "video" },
            { number: 2, name: "TV Funda√ß√£o", url: "https://cdn-fundacao-2110.ciclano.io:1443/fundacao-2110/fundacao-2110/chunklist_w175723033.m3u8", type: "video" },
            { number: 3, name: "TV Band PA", url: "https://cdn.live.br1.jmvstream.com/w/LVW-15748/LVW15748_Yed7yzLuRC/chunklist.m3u8", type: "video" },
            { number: 4, name: "TV Cine", url: "https://stmv1.srvif.com/tvserie/tvserie/chunklist_w1823388845.m3u8", type: "video" },
            { number: 5, name: "TV C√¢mara", url: "https://stream3.camara.gov.br/tv1/manifest.m3u8", type: "video" },
            { number: 6, name: "TV Brasil", url: "https://tvbrasil-stream.ebc.com.br/index.m3u8", type: "video" },
            { number: 7, name: "Cine Classic", url: "https://live20.bozztv.com/giatvplayout7/giatv-208272/tracks-v1a1/mono.ts.m3u8", type: "video" },
            { number: 8, name: "TV Pai Eterno", url: "https://video09.logicahost.com.br/paieterno/paieterno/chunklist_w978992163.m3u8", type: "video" },
            { number: 9, name: "TV Cidade Verde", url: "https://televisaocidadeverde.brasilstream.com.br/hls/televisaocidadeverde/index.m3u8", type: "video" },
            { number: 10, name: "Record MT", url: "https://cdn.live.br1.jmvstream.com/w/LVW-10841/LVW10841_mT77z9o2cP/chunklist.m3u8", type: "video" },
            { number: 11, name: "Rede Manchete", url: "https://stmv1.srvif.com/tvserie/tvserie/chunklist_w2147211548.m3u8", type: "video" },
            { number: 12, name: "Rede TV TO", url: "https://ikki.hubcloud.tv.br/RedeTVTO/tracks-v1a1/mono.m3u8", type: "video" },
            { number: 13, name: "TV Aparecida", url: "https://cdn.jmvstream.com/w/LVW-9716/LVW9716_HbtQtezcaw/playlist.m3u8", type: "video" },
            { number: 14, name: "TV Universal", url: "https://644398c.ha.azioncdn.net/primary/tvuniversal_480p.sdp/chunklist_b946bba4-523a-4655-b6f5-5d73b6135593.m3u8", type: "video" },
            { number: 15, name: "RIT TV", url: "https://acesso.ecast.site:3648/live/ritlive.m3u8", type: "video" },
            { number: 16, name: "TV Mon", url: "https://srv1.zcast.com.br/tvmon/tvmon/playlist.m3u8", type: "video" },
            { number: 17, name: "TV Rede Brasil", url: "https://video09.logicahost.com.br/redebrasiloficial/redebrasiloficial/chunklist_w408678569.m3u8", type: "video" },
            { number: 18, name: "Rede Vida", url: "https://d12e4o88jd8gex.cloudfront.net/out/v1/cea3de0b76ac4e82ab8ee0fd3f17ce12/index_2.m3u8", type: "video" },
            { number: 19, name: "Soul TV", url: "https://video01.soultv.com.br/soultv/soultv/playlist.m3u8", type: "video" },
            { number: 20, name: "TV Rede Gospel", url: "https://cdn.live.br1.jmvstream.com/w/LVW-8719/LVW8719_AcLVAxWy5J/playlist.m3u8", type: "video" },
            { number: 21, name: "TV Galega", url: "https://cdn.jmvstream.com/w/LVW-8538/LVW8538_KBtZ9UMIZn/chunklist.m3u8", type: "video" },
            { number: 22, name: "TV Brusque", url: "https://5ad482a77183d.streamlock.net/rodrigotvbrusque.com.br/_definst_/5d880199c902eb4a1e8df00d/chunklist_w302981591.m3u8", type: "video" },
            { number: 23, name: "TV Dubai Racing", url: "https://dmithrvllta.cdn.mgmlcdn.com/dubairacing/smil:dubairacing.smil/chunklist_b1500000.m3u8", type: "video" },
            { number: 24, name: "TVR Sul", url: "https://5a57bda70564a.streamlock.net/tvrsul/tvrsul.sdp/chunklist_w1778416456.m3u8", type: "video" },
            { number: 25, name: "TV Mais", url: "https://stmv1.paineltv.net/tvmaisbrasil/tvmaisbrasil/playlist.m3u8", type: "video" },
            { number: 26, name: "TV Mundial", url: "https://58a4464faef53.streamlock.net/impd/ngrp:impd_all/chunklist_w1976879677_b796000.m3u8", type: "video" },
            { number: 27, name: "Rede Plenitude TV", url: "https://meupainel.top:1936/iaptd/iaptd/chunklist_w1718098717.m3u8", type: "video" },
            { number: 28, name: "Fonte TV", url: "https://59fb88a1b1108.streamlock.net/fonte/_definst_/fontetv/chunklist_w1319813731.m3u8", type: "video" },
            { number: 29, name: "TV Novo Tempo", url: "https://stream.live.novotempo.com/tv/smil:tvnovotempo.smil/playlist.m3u8", type: "video" },
            { number: 30, name: "Euro News", url: "https://www.youtube.com/watch?v=XuZAl-ZPEcA", type: "youtube" },
            { number: 31, name: "TV Aberta", url: "https://br5093.streamingdevideo.com.br/tvaberto/tvaberto/playlist.m3u8", type: "video" },
            { number: 32, name: "Rede Fam√≠lia", url: "https://tv03.zas.media:1936/rftv/rftv/playlist.m3u8", type: "video" },
            { number: 33, name: "BS TV", url: "https://br5093.streamingdevideo.com.br/bstv/bstv/playlist.m3u8", type: "video" },
            { number: 34, name: "TV Max 90", url: "https://cdn.jmvstream.com/w/AVJ-15538/playlist/playlist.m3u8", type: "video" },
            { number: 35, name: "TV Thathi", url: "https://cdn-grupo-10049.ciclano.io:1443/grupo-10049/grupo-10049/playlist.m3u8", type: "video" },
            { number: 36, name: "TV ABC Brasil", url: "https://stmv1.srvstm.com/abc7891/abc7891/playlist.m3u8", type: "video" },
            { number: 37, name: "TV Unisantos", url: "https://live.cdn.upx.com/7550/myStream.sdp/playlist.m3u8", type: "video" },
            { number: 38, name: "TV Vintage", url: "https://video01.kshost.com.br:4443/rogerio7271/rogerio7271/playlist.m3u8", type: "video" },
            { number: 39, name: "Rede TV Mais", url: "https://cdn.jmvstream.com/w/AVJ-15235/playlist/playlist.m3u8", type: "video" },
            { number: 40, name: "TV CaZ√©", url: "https://www.youtube.com/@CazeTV", type: "youtube_channel", liveMode: true },
            { number: 41, name: "Fox Sports", url: "https://live-news-manifest.tubi.video/live-news-manifest/csm/extlive/tubiprd01,Fox-Sports-Espanol2.m3u8", type: "video" },
            { number: 42, name: "RS News Sports", url: "https://video03.logicahost.com.br/rssports4/rssports4/playlist.m3u8", type: "video" },
            { number: 43, name: "CBS Sports", url: "https://dai.google.com/linear/hls/event/GxrCGmwST0ixsrc_QgB6qw/master.m3u8", type: "video" },
            { number: 44, name: "Rete8 Sport", url: "https://64b16f23efbee.streamlock.net/rete8sport/rete8sport/playlist.m3u8", type: "video" },
            { number: 45, name: "Trace Sport Stars", url: "https://lightning-tracesport-samsungau.amagi.tv/playlist1080p.m3u8", type: "video" },
            { number: 46, name: "Motor Racing TV", url: "https://d35j504z0x2vu2.cloudfront.net/v1/master/0bc8e8376bd8417a1b6761138aa41c26c7309312/motorracing/master.m3u8", type: "video" },
            { number: 47, name: "Sobrenatural TV", url: "https://stream-36723.castr.net/5d714f6a0bd97874e36f14e4/live_057ee4605c1711efbd4135c4457c726c/rewind-3600.m3u8", type: "video" },
            { number: 48, name: "TV Futuro", url: "https://tv03.zas.media:1936/tvfuturo/tvfuturo/playlist.m3u8", type: "video" },
            { number: 49, name: "TV Internacional", url: "https://raw.githubusercontent.com/ipstreet312/freeiptv/master/ressources/tvipt/sh/tviint.m3u8", type: "video" },
            { number: 50, name: "TV Templo", url: "https://664398c.ha.azioncdn.net/primary/tvtemplo_480p.sdp/playlist.m3u8", type: "video" },
            { number: 51, name: "Rede Super", url: "https://tv02.zas.media:1936/redesuper/redesuper/playlist.m3u8", type: "video" },
            { number: 52, name: "CBS News", url: "https://www.cbsnews.com/common/video/cbsn-ny-prod.m3u8", type: "video" },
            { number: 53, name: "SBT Rio", url: "https://www.youtube.com/watch?v=LLpNUqHVam8", type: "youtube" },
            { number: 54, name: "Band TV", url: "https://cdn.jmvstream.com/w/LVW-15748/LVW15748_Yed7yzLuRC/playlist.m3u8", type: "video" },
            { number: 55, name: "SBT PI", url: "https://stmv1.transmissaodigital.com/cidadeverdenovo/cidadeverdenovo/chunklist_w1550736161.m3u8", type: "video" },
            { number: 56, name: "SBT Central", url: "https://www.youtube.com/watch?v=LLpNUqHVam8", type: "youtube" },
            { number: 57, name: "Record RN", url: "https://video07.logicahost.com.br/portaldatropical/portaldatropical/chunklist_w1630150607.m3u8", type: "video" },
            { number: 58, name: "TV Guar√°", url: "https://video02.logicahost.com.br/tvguara23/tvguara23/chunklist_w578184061.m3u8", type: "video" },
            { number: 59, name: "SBT Ribeir√£o Preto", url: "https://www.youtube.com/watch?v=wJQUfbr69P0", type: "youtube" },
            { number: 60, name: "RIT TV", url: "https://acesso.ecast.site:3648/live/ritlive.m3u8", type: "video" },
            { number: 61, name: "CNN Brasil", url: "https://www.youtube.com/@CNNBrasil", type: "youtube_channel" },
            { number: 62, name: "TV Pantanal", url: "https://5a2b083e9f360.streamlock.net/tvpantanal/tvpantanal.sdp/chunklist_w1595845833.m3u8", type: "video" },
            { number: 63, name: "C√¢mara Pedro Afonso", url: "https://www.youtube.com/watch?v=5_b3D64oS3A", type: "youtube" },
            { number: 64, name: "Record News", url: "https://www.youtube.com/@recordnews", type: "youtube_channel" },
            { number: 65, name: "TV Senado", url: "https://www.youtube.com/watch?v=2XmxELSjlEg", type: "youtube" },
            { number: 66, name: "TV Evangelizar", url: "https://tvevangelizar.brasilstream.com.br/hls/tvevangelizar/index.m3u8", type: "video" },
            { number: 67, name: "Canal Rural", url: "https://607d2a1a47b1f.streamlock.net/crur/smil:canalrural.smil/chunklist_w671731343_b259600_sleng.m3u8", type: "video" },
            { number: 68, name: "TV ISTV", url: "https://video08.logicahost.com.br/istvnacional/srt.stream/chunklist_w27865936.m3u8", type: "video" },
            { number: 69, name: "Vima MAX", url: "https://srv3.zcast.com.br/vivaxtv/vivaxtv/chunklist_w1101571165.m3u8", type: "video" },
            { number: 70, name: "SIC TV", url: "https://d1zx6l1dn8vaj5.cloudfront.net/out/v1/b89cc37caa6d418eb423cf092a2ef970/index_4.m3u8", type: "video" },
            { number: 71, name: "AWTV", url: "https://streaming.cloudecast.com/hls/awtv/index.m3u8", type: "video" },
            { number: 72, name: "SIC News TV", url: "https://d277k9d1h9dro4.cloudfront.net/out/v1/293e7c3464824cbd8818ab8e49dc5fe9/index_5.m3u8", type: "video" },
            { number: 73, name: "TV Aparecida 2", url: "https://www.youtube.com/watch?v=4CAmwaFJo6k", type: "youtube" },
            { number: 74, name: "SCC SBT", url: "https://www.youtube.com/@SCCSBT", type: "youtube_channel", liveMode: true },
            { number: 75, name: "TV Escola", url: "https://cdn-fundacao-2110.ciclano.io:1443/fundacao-2110/fundacao-2110/chunklist_w175723033.m3u8", type: "video" },
            { number: 76, name: "R√°dio Oliven√ßa FM", url: "https://server12.srvsh.com.br:8074/stream", type: "audio" },
            { number: 77, name: "R√°dio Vale FM", url: "https://s37.maxcast.com.br:8058/live", type: "audio" },
            { number: 78, name: "R√°dio Jovem Palmas", url: "http://sd.dnip.com.br:10422/stream", type: "audio" },
            { number: 79, name: "R√°dio HCJB", url: "https://streamingecuador.net:8287/hcjb", type: "audio" },
            { number: 80, name: "R√°dio Ativa FM", url: "http://servidor33.brlogic.com:8224/live", type: "audio" },
            { number: 81, name: "R√°dio Paraiso FM", url: "https://sonicpanel.oficialserver.com/8112/stream", type: "audio" },
            { number: 82, name: "R√°dio Executiva FM", url: "https://live.ojc.com.br/e9cd_6/myStream.m3u8", type: "video" },
            { number: 83, name: "CBN Tocantins", url: "https://live.ojc.com.br/e9cd_6/myStream.m3u8", type: "video" },
            { number: 84, name: "R√°dio Tocantins PN", url: "https://sv1.audiostream.com.br/radio/8040/stream", type: "audio" },
            { number: 85, name: "R√°dio Itatiaia", url: "https://8903.brasilstream.com.br/stream", type: "audio" },
            { number: 86, name: "R√°dio Unitins FM", url: "https://live.unitins.br", type: "audio" },
            { number: 87, name: "R√°dio Porto", url: "https://sonicpanel.oficialserver.com:7120/stream", type: "audio" },
            { number: 88, name: "R√°dio Transam√©rica", url: "https://playerservices.streamtheworld.com/api/livestream-redirect/RT_SPAAC.aac", type: "audio" },
            { number: 89, name: "TV Nova PE", url: "https://acesso.ecast.site:3675/live/novatvlive.m3u8", type: "video" },
            { number: 90, name: "TV Can√ß√£o Nova", url: "https://www.youtube.com/@tvcancaonova", type: "youtube_channel" }
        ];

        // ========== VARI√ÅVEIS GLOBAIS ==========
        let currentChannelIndex = 0;
        let focusedChannelIndex = 0;
        let isPlaying = false;
        let currentPlayer = null;
        let currentPlayerType = null;
        let audioContext = null;
        let audioAnalyser = null;
        let audioSource = null;
        let audioVisualizer = null;
        let equalizerBars = [];
        let numberInputBuffer = "";
        let numberInputTimeout;
        let fullscreenInfoTimeout;
        let channelPlaylists = new Map();
        let currentVideoIndex = 0;
        let liveCheckInterval = null;
        let isInLiveMode = false;
        let originalVideoId = null;
        let wakeLock = null;
        let channelData = new Map(); // Cache para dados dos canais

        // ========== ELEMENTOS DOM ==========
        const channelList = document.getElementById('channelList');
        const clapprContainer = document.getElementById('clappr');
        const alternativeContainer = document.getElementById('alternativePlayer');
        const videoPlaceholder = document.getElementById('videoPlaceholder');
        const infoPanel = document.getElementById('infoPanel');
        const fullscreenInfo = document.getElementById('fullscreenInfo');
        const channelNumberDisplay = document.getElementById('channelNumberDisplay');
        const audioVisualizerEl = document.getElementById('audioVisualizer');

        // ========== INICIALIZA√á√ÉO ==========
        document.addEventListener('DOMContentLoaded', function() {
            initSplashScreen();
        });

        // ========== GERENCIAMENTO DO SPLASH SCREEN ==========
        function initSplashScreen() {
            const splashScreen = document.getElementById('splashScreen');
            const mainApp = document.getElementById('mainApp');
            const loadingText = document.querySelector('.loading-text');
            
            if (!splashScreen || !mainApp || !loadingText) {
                console.error('Elementos do splash screen n√£o encontrados');
                return;
            }
            
            const loadingMessages = [
                'Inicializando sistema...',
                'Conectando aos servidores...',
                'Carregando canais...',
                'Verificando sinais...',
                'Preparando interface...',
                'Pronto para transmitir!'
            ];
            
            let messageIndex = 0;
            
            const messageInterval = setInterval(() => {
                if (messageIndex < loadingMessages.length && loadingText) {
                    loadingText.textContent = loadingMessages[messageIndex];
                    messageIndex++;
                } else {
                    clearInterval(messageInterval);
                }
            }, 500);
            
            playSplashSound();
            
            setTimeout(() => {
                if (splashScreen) {
                    splashScreen.style.display = 'none';
                }
                if (mainApp) {
                    mainApp.style.display = 'flex';
                }
                
                initializeApp();
                playStartupSound();
            }, 4000);
        }

        function playSplashSound() {
            try {
                const audio = new Audio(SPLASH_SOUND_URL);
                audio.volume = 1.0;
                audio.play().catch(e => {
                    console.log('N√£o foi poss√≠vel tocar o som da splash:', e);
                });
            } catch (e) {
                console.log('Erro ao carregar som da splash:', e);
            }
        }

        function initializeApp() {
            try {
                console.log('üöÄ Inicializando Stream Play Enhanced...');
                console.log('üéÆ Sistema robusto de auto-hide dos controles Clappr carregado');
                console.log('üì∫ Sistema avan√ßado de canais YouTube implementado');
                console.log('üì± Responsividade mobile aprimorada ativada');
                console.log('üì± Dispositivo detectado:', {
                    userAgent: navigator.userAgent,
                    isMobile: deviceInfo.isMobile,
                    isTouch: deviceInfo.isTouchDevice,
                    orientation: window.innerWidth > window.innerHeight ? 'landscape' : 'portrait',
                    screenSize: `${window.innerWidth}x${window.innerHeight}`,
                    ...deviceInfo
                });
                
                loadChannels();
                setupKeyboardControls();
                setupRemoteControls();
                setupTouchControls();
                setupAudioVisualizer();
                showActiveChannelNameOverlay();
                
                if (deviceInfo.isMobile) {
                    document.body.classList.add('mobile-device');
                    console.log('üì± Classe mobile-device aplicada');
                    console.log('‚ÑπÔ∏è Bot√£o INFO ser√° escondido em dispositivos m√≥veis');
                }
                if (deviceInfo.isTV) {
                    document.body.classList.add('tv-device');
                    console.log('üì∫ Classe tv-device aplicada');
                }
                
                setTimeout(() => {
                    initializeAutoStart();
                }, 200);
            } catch (error) {
                console.error('‚ùå Erro ao inicializar aplica√ß√£o:', error);
            }
        }

        function playStartupSound() {
            try {
                const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioCtx.createOscillator();
                const gainNode = audioCtx.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioCtx.destination);
                
                oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(400, audioCtx.currentTime + 0.3);
                
                gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                
                oscillator.start(audioCtx.currentTime);
                oscillator.stop(audioCtx.currentTime + 0.3);
            } catch (e) {
                console.log('√Åudio n√£o dispon√≠vel');
            }
        }

        // ========== SISTEMA DE AUTO-START ==========
        function initializeAutoStart() {
            try {
                let targetChannelIndex = 0;
                
                try {
                    const lastChannel = localStorage.getItem('lastWatchedChannel');
                    if (lastChannel !== null) {
                        const channelIndex = parseInt(lastChannel);
                        if (channelIndex >= 0 && channelIndex < channels.length) {
                            targetChannelIndex = channelIndex;
                            console.log('Restaurando √∫ltimo canal assistido:', channels[channelIndex].name);
                        }
                    }
                } catch (e) {
                    console.log('LocalStorage n√£o dispon√≠vel, usando canal padr√£o');
                }
                
                console.log('Auto-iniciando canal:', channels[targetChannelIndex].name);
                selectChannel(targetChannelIndex);
                focusChannel(targetChannelIndex);
                
                setTimeout(() => {
                    verifyAutoStart(targetChannelIndex);
                }, 2000);
                
            } catch (error) {
                console.error('Erro no auto-start:', error);
                setTimeout(() => {
                    selectChannel(0);
                    focusChannel(0);
                }, 1000);
            }
        }

        function verifyAutoStart(targetIndex) {
            const placeholder = document.getElementById('videoPlaceholder');
            const isVideoActive = currentPlayer !== null && currentPlayerType !== null;
            const placeholderVisible = placeholder && placeholder.style.display !== 'none' && 
                                      placeholder.textContent.includes('Selecione um canal');
            
            if (!isVideoActive || placeholderVisible) {
                console.log('Auto-start falhou, tentando novamente...');
                selectChannel(targetIndex);
                
                setTimeout(() => {
                    const stillFailed = !currentPlayer || placeholder.textContent.includes('Selecione um canal');
                    if (stillFailed) {
                        console.log('Auto-start falhou novamente, tentando canal 0...');
                        selectChannel(0);
                    }
                }, 2000);
            } else {
                console.log('Auto-start bem-sucedido!');
            }
        }

        // ========== AUDIO VISUALIZER ==========
        function setupAudioVisualizer() {
            const equalizer = document.getElementById('equalizer');
            
            for (let i = 0; i < 32; i++) {
                const bar = document.createElement('div');
                bar.className = 'equalizer-bar';
                bar.style.animationDelay = `${i * 0.05}s`;
                equalizer.appendChild(bar);
                equalizerBars.push(bar);
            }
            
            setInterval(() => {
                if (audioVisualizerEl.classList.contains('active')) {
                    equalizerBars.forEach((bar, index) => {
                        const height = Math.random() * 140 + 10;
                        bar.style.height = `${height}px`;
                    });
                }
            }, 150);
        }

        // ========== CARREGAMENTO DE CANAIS ==========
        function loadChannels() {
            const channelList = document.getElementById('channelList');
            if (!channelList) {
                console.error('Lista de canais n√£o encontrada');
                return;
            }
            
            channelList.innerHTML = '';
            channels.forEach((channel, index) => {
                const li = document.createElement('li');
                li.className = 'channel-item';
                li.setAttribute('tabindex', '0');
                li.setAttribute('data-index', index);
                
                const typeIcon = getChannelTypeIcon(channel.type);
                li.innerHTML = `
                    <span class="channel-number">${channel.number}</span>
                    <span class="channel-name">${typeIcon} ${channel.name}</span>
                `;
                li.addEventListener('click', () => selectChannel(index));
                channelList.appendChild(li);
            });
        }

        function getChannelTypeIcon(type) {
            switch(type) {
                case 'audio': return 'üéµ';
                case 'youtube': return 'üé¨';
                case 'youtube_channel': return 'üì∫';
                case 'video': return 'üì∫';
                default: return 'üì∫';
            }
        }

        // ========== FEEDBACK T√ÅTIL ==========
        function vibrateFeedback(duration = 50) {
            if (deviceInfo.isMobile && 'vibrate' in navigator) {
                navigator.vibrate(duration);
            }
        }

        // ========== SELE√á√ÉO DE CANAIS ==========
        function selectChannel(index) {
            if (index < 0 || index >= channels.length) {
                console.error('√çndice de canal inv√°lido:', index);
                return;
            }
            
            vibrateFeedback();
            
            try {
                console.log(`Selecionando canal ${channels[index].number}: ${channels[index].name}`);
                
                const previousActive = document.querySelector('.channel-item.active');
                if (previousActive) {
                    previousActive.classList.remove('active');
                }
                
                const channelItems = document.querySelectorAll('.channel-item');
                if (channelItems[index]) {
                    channelItems[index].classList.add('active');
                    channelItems[index].scrollIntoView({ block: 'nearest', behavior: 'smooth' });
                }
                
                currentChannelIndex = index;
                focusedChannelIndex = index;
                
                try {
                    localStorage.setItem('lastWatchedChannel', index.toString());
                } catch (e) {
                    console.log('N√£o foi poss√≠vel salvar √∫ltimo canal:', e);
                }
                
                const channel = channels[index];
                console.log(`Carregando canal tipo "${channel.type}":`, channel.url);
                
                loadChannel(channel);
                updateChannelInfo(channel);
                updateChannelNameOverlay();
                
                const placeholder = document.getElementById('videoPlaceholder');
                if (placeholder && placeholder.textContent.includes('Selecione um canal')) {
                    placeholder.style.display = 'none';
                }
                
            } catch (error) {
                console.error('Erro ao selecionar canal:', error);
            }
        }

        // ========== CARREGAMENTO DE CANAL ==========
        function loadChannel(channel) {
            console.log('Iniciando carregamento do canal:', channel.name, 'Tipo:', channel.type);
            
            cleanupPlayers();
            audioVisualizerEl.classList.remove('active');
            
            const placeholder = document.getElementById('videoPlaceholder');
            placeholder.style.display = 'flex';
            placeholder.innerHTML = `
                <div style="text-align: center;">
                    <div class="loading-spinner"></div>
                    <p style="margin-top: 10px;">Carregando ${channel.name}...</p>
                    <p style="font-size: 0.9rem; color: #ccc;">Canal ${channel.number}</p>
                </div>
            `;
            
            switch(channel.type) {
                case 'youtube_channel':
                    console.log('Carregando canal YouTube (URL de canal)...');
                    loadYouTubeChannelFromURL(channel);
                    break;
                case 'youtube':
                    console.log('Carregando canal YouTube (URL de v√≠deo)...');
                    loadYouTubeChannel(channel);
                    break;
                case 'audio':
                    console.log('Carregando canal de √°udio...');
                    loadAudioChannel(channel);
                    break;
                case 'video':
                default:
                    console.log('Carregando canal de v√≠deo...');
                    loadVideoChannel(channel);
                    break;
            }
        }

        // ========== SISTEMA AVAN√áADO DE CANAIS YOUTUBE ==========

        // ========== FUN√á√ïES PARA EXTRAIR CHANNEL ID DE DIFERENTES FORMATOS DE URL ==========
        async function extractChannelIdFromURL(url) {
            try {
                console.log('üîç Extraindo Channel ID da URL:', url);
                
                // Limpa a URL
                const cleanUrl = url.split('?')[0].split('#')[0];
                
                // 1. Canal direto com ID: https://www.youtube.com/channel/UCxxxxxx
                let match = cleanUrl.match(/youtube\.com\/channel\/([a-zA-Z0-9_-]+)/);
                if (match) {
                    console.log('‚úÖ Channel ID extra√≠do diretamente:', match[1]);
                    return match[1];
                }
                
                // 2. Handle moderno: https://www.youtube.com/@handle
                match = cleanUrl.match(/youtube\.com\/@([a-zA-Z0-9_-]+)/);
                if (match) {
                    console.log('üîç Handle encontrado, buscando Channel ID:', match[1]);
                    return await getChannelIdFromHandle(match[1]);
                }
                
                // 3. Canal personalizado: https://www.youtube.com/c/nome
                match = cleanUrl.match(/youtube\.com\/c\/([a-zA-Z0-9_-]+)/);
                if (match) {
                    console.log('üîç Canal customizado encontrado, buscando Channel ID:', match[1]);
                    return await getChannelIdFromCustomName(match[1]);
                }
                
                // 4. Nome de usu√°rio antigo: https://www.youtube.com/user/nome
                match = cleanUrl.match(/youtube\.com\/user\/([a-zA-Z0-9_-]+)/);
                if (match) {
                    console.log('üîç Nome de usu√°rio encontrado, buscando Channel ID:', match[1]);
                    return await getChannelIdFromUsername(match[1]);
                }
                
                // 5. Canal direto sem /c/: https://www.youtube.com/nomecustomizado
                match = cleanUrl.match(/youtube\.com\/([a-zA-Z0-9_-]+)$/);
                if (match && !['watch', 'playlist', 'channel', 'user', 'c'].includes(match[1])) {
                    console.log('üîç Nome direto encontrado, buscando Channel ID:', match[1]);
                    return await getChannelIdFromCustomName(match[1]);
                }
                
                console.error('‚ùå Formato de URL n√£o reconhecido:', url);
                return null;
                
            } catch (error) {
                console.error('‚ùå Erro ao extrair Channel ID:', error);
                return null;
            }
        }

        async function getChannelIdFromHandle(handle) {
            if (!YOUTUBE_API_KEY || YOUTUBE_API_KEY === 'AIzaSyCNL4lsOgLRiRj1jc_5c0OVTK_E85ChVMc') {
                console.log('‚ö†Ô∏è API Key n√£o configurada para busca por handle');
                return null;
            }
            
            try {
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${handle}&type=channel&maxResults=1&key=${YOUTUBE_API_KEY}`
                );
                
                if (!response.ok) throw new Error('Erro na busca por handle');
                
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    const channelId = data.items[0].snippet.channelId;
                    console.log('‚úÖ Channel ID encontrado via handle:', channelId);
                    return channelId;
                }
                
                return null;
            } catch (error) {
                console.error('‚ùå Erro ao buscar Channel ID por handle:', error);
                return null;
            }
        }

        async function getChannelIdFromCustomName(customName) {
            if (!YOUTUBE_API_KEY || YOUTUBE_API_KEY === 'AIzaSyCNL4lsOgLRiRj1jc_5c0OVTK_E85ChVMc') {
                console.log('‚ö†Ô∏è API Key n√£o configurada para busca por nome customizado');
                return null;
            }
            
            try {
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${customName}&type=channel&maxResults=1&key=${YOUTUBE_API_KEY}`
                );
                
                if (!response.ok) throw new Error('Erro na busca por nome customizado');
                
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    const channelId = data.items[0].snippet.channelId;
                    console.log('‚úÖ Channel ID encontrado via nome customizado:', channelId);
                    return channelId;
                }
                
                return null;
            } catch (error) {
                console.error('‚ùå Erro ao buscar Channel ID por nome customizado:', error);
                return null;
            }
        }

        async function getChannelIdFromUsername(username) {
            if (!YOUTUBE_API_KEY || YOUTUBE_API_KEY === 'AIzaSyCNL4lsOgLRiRj1jc_5c0OVTK_E85ChVMc') {
                console.log('‚ö†Ô∏è API Key n√£o configurada para busca por username');
                return null;
            }
            
            try {
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/channels?part=id&forUsername=${username}&key=${YOUTUBE_API_KEY}`
                );
                
                if (!response.ok) throw new Error('Erro na busca por username');
                
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    const channelId = data.items[0].id;
                    console.log('‚úÖ Channel ID encontrado via username:', channelId);
                    return channelId;
                }
                
                // Fallback: tentar busca geral
                return await getChannelIdFromCustomName(username);
            } catch (error) {
                console.error('‚ùå Erro ao buscar Channel ID por username:', error);
                return null;
            }
        }

        // ========== FUN√á√ïES PARA BUSCAR √öLTIMOS V√çDEOS DO CANAL ==========
        async function getLatestChannelVideos(channelId, maxResults = 50) {
            if (!YOUTUBE_API_KEY || YOUTUBE_API_KEY === 'AIzaSyCNL4lsOgLRiRj1jc_5c0OVTK_E85ChVMc') {
                console.log('‚ö†Ô∏è API Key n√£o configurada para buscar v√≠deos');
                return [];
            }
            
            try {
                console.log('üìπ Buscando √∫ltimos v√≠deos do canal:', channelId);
                
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${channelId}&type=video&order=date&maxResults=${maxResults}&key=${YOUTUBE_API_KEY}`
                );
                
                if (!response.ok) throw new Error('Erro ao buscar v√≠deos do canal');
                
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    const videos = data.items.map(item => ({
                        videoId: item.id.videoId,
                        title: item.snippet.title,
                        publishedAt: item.snippet.publishedAt,
                        description: item.snippet.description
                    }));
                    
                    console.log(`‚úÖ ${videos.length} v√≠deos encontrados para o canal`);
                    return videos;
                }
                
                return [];
            } catch (error) {
                console.error('‚ùå Erro ao buscar v√≠deos do canal:', error);
                return [];
            }
        }

        async function checkChannelLiveStream(channelId) {
            if (!YOUTUBE_API_KEY || YOUTUBE_API_KEY === 'AIzaSyCNL4lsOgLRiRj1jc_5c0OVTK_E85ChVMc') {
                console.log('‚ö†Ô∏è API Key n√£o configurada para verificar lives');
                return { isLive: false };
            }
            
            try {
                console.log('üî¥ Verificando se h√° live no canal:', channelId);
                
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${channelId}&type=video&eventType=live&maxResults=1&key=${YOUTUBE_API_KEY}`
                );
                
                if (!response.ok) throw new Error('Erro ao verificar live');
                
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    const liveVideo = data.items[0];
                    console.log('üî¥ Live detectada:', liveVideo.snippet.title);
                    return {
                        isLive: true,
                        videoId: liveVideo.id.videoId,
                        title: liveVideo.snippet.title,
                        url: `https://www.youtube.com/watch?v=${liveVideo.id.videoId}`
                    };
                }
                
                console.log('üì∫ Nenhuma live ativa no canal');
                return { isLive: false };
            } catch (error) {
                console.error('‚ùå Erro ao verificar live do canal:', error);
                return { isLive: false };
            }
        }

        // ========== CARREGAMENTO DE CANAL YOUTUBE VIA URL DE CANAL ==========
        async function loadYouTubeChannelFromURL(channel) {
            const placeholder = document.getElementById('videoPlaceholder');
            
            try {
                console.log('üé¨ Carregando canal YouTube pela URL:', channel.url);
                
                // Extrai o Channel ID da URL
                const channelId = await extractChannelIdFromURL(channel.url);
                
                if (!channelId) {
                    console.error('‚ùå N√£o foi poss√≠vel extrair Channel ID da URL');
                    showError(channel);
                    return;
                }
                
                console.log('‚úÖ Channel ID extra√≠do:', channelId);
                
                // Verifica se h√° cache para este canal
                let channelInfo = channelData.get(channel.number);
                
                if (!channelInfo) {
                    // Busca informa√ß√µes do canal e v√≠deos
                    placeholder.innerHTML = `
                        <div style="text-align: center;">
                            <div class="loading-spinner"></div>
                            <p style="margin-top: 10px;">Carregando dados do canal...</p>
                            <p style="font-size: 0.9rem; color: #ccc;">${channel.name}</p>
                        </div>
                    `;
                    
                    const [videos, channelDetails] = await Promise.all([
                        getLatestChannelVideos(channelId),
                        getChannelDetails(channelId)
                    ]);
                    
                    if (videos.length === 0) {
                        console.error('‚ùå Nenhum v√≠deo encontrado no canal');
                        showError(channel);
                        return;
                    }
                    
                    channelInfo = {
                        channelId: channelId,
                        videos: videos,
                        details: channelDetails,
                        currentVideoIndex: 0
                    };
                    
                    channelData.set(channel.number, channelInfo);
                    console.log(`‚úÖ Canal carregado: ${videos.length} v√≠deos encontrados`);
                }
                
                // Verifica se h√° live ativa
                if (channel.liveMode !== false) {
                    placeholder.innerHTML = `
                        <div style="text-align: center;">
                            <div class="loading-spinner"></div>
                            <p style="margin-top: 10px;">Verificando transmiss√µes ao vivo...</p>
                        </div>
                    `;
                    
                    const liveCheck = await checkChannelLiveStream(channelId);
                    
                    if (liveCheck.isLive) {
                        console.log('üî¥ Live detectada! Reproduzindo ao vivo:', liveCheck.title);
                        isInLiveMode = true;
                        loadYouTubePlayer(liveCheck.url, channel, true);
                        startChannelLiveMonitoring(channel, channelId);
                        return;
                    }
                }
                
                // Reproduz o √∫ltimo v√≠deo do canal
                console.log('üì∫ Reproduzindo √∫ltimo v√≠deo do canal');
                isInLiveMode = false;
                currentVideoIndex = 0;
                playChannelVideo(channel, channelInfo);
                startChannelLiveMonitoring(channel, channelId);
                
            } catch (error) {
                console.error('‚ùå Erro ao carregar canal YouTube:', error);
                showError(channel);
            }
        }

        async function getChannelDetails(channelId) {
            if (!YOUTUBE_API_KEY || YOUTUBE_API_KEY === 'AIzaSyCNL4lsOgLRiRj1jc_5c0OVTK_E85ChVMc') {
                return {};
            }
            
            try {
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics&id=${channelId}&key=${YOUTUBE_API_KEY}`
                );
                
                if (!response.ok) throw new Error('Erro ao buscar detalhes do canal');
                
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    return {
                        title: data.items[0].snippet.title,
                        description: data.items[0].snippet.description,
                        subscriberCount: data.items[0].statistics?.subscriberCount,
                        videoCount: data.items[0].statistics?.videoCount
                    };
                }
                
                return {};
            } catch (error) {
                console.error('‚ùå Erro ao buscar detalhes do canal:', error);
                return {};
            }
        }

        function playChannelVideo(channel, channelInfo) {
            const videos = channelInfo.videos;
            const currentVideo = videos[channelInfo.currentVideoIndex];
            
            if (!currentVideo) {
                console.error('‚ùå V√≠deo n√£o encontrado no √≠ndice:', channelInfo.currentVideoIndex);
                showError(channel);
                return;
            }
            
            const videoUrl = `https://www.youtube.com/watch?v=${currentVideo.videoId}`;
            console.log(`üìπ Reproduzindo v√≠deo ${channelInfo.currentVideoIndex + 1}/${videos.length}: ${currentVideo.title}`);
            
            // Callback para pr√≥ximo v√≠deo quando terminar
            const onVideoEnd = () => {
                setTimeout(() => {
                    if (!isInLiveMode && channels[currentChannelIndex] === channel) {
                        nextChannelVideo(channel);
                    }
                }, 2000);
            };
            
            loadYouTubePlayer(videoUrl, channel, false, onVideoEnd);
            updateChannelInfoWithPlaylist(channel, channelInfo);
        }

        function nextChannelVideo(channel) {
            const channelInfo = channelData.get(channel.number);
            if (!channelInfo) return;
            
            channelInfo.currentVideoIndex++;
            
            // Loop infinito: volta ao primeiro v√≠deo
            if (channelInfo.currentVideoIndex >= channelInfo.videos.length) {
                channelInfo.currentVideoIndex = 0;
                console.log('üîÑ Fim da playlist do canal, reiniciando do primeiro v√≠deo');
            }
            
            setTimeout(() => {
                if (!isInLiveMode && channels[currentChannelIndex] === channel) {
                    playChannelVideo(channel, channelInfo);
                }
            }, 1000);
        }

        function updateChannelInfoWithPlaylist(channel, channelInfo) {
            const playlistInfo = ` (${channelInfo.currentVideoIndex + 1}/${channelInfo.videos.length})`;
            const channelName = channel.name + playlistInfo;
            
            document.getElementById('currentChannelName').textContent = channelName;
            document.getElementById('fsChannelName').textContent = channelName;
            
            // Atualiza overlay com nome do v√≠deo atual
            const overlay = document.getElementById('channel-name-overlay');
            if (overlay) {
                const currentVideo = channelInfo.videos[channelInfo.currentVideoIndex];
                overlay.textContent = `${channel.name} - ${currentVideo.title}`;
            }
        }

        function startChannelLiveMonitoring(channel, channelId) {
            // Para monitoramento anterior
            stopLiveMonitoring();
            
            if (!YOUTUBE_API_KEY || YOUTUBE_API_KEY === 'AIzaSyCNL4lsOgLRiRj1jc_5c0OVTK_E85ChVMc') {
                return;
            }
            
            console.log('üîç Iniciando monitoramento de live para o canal:', channel.name);
            
            liveCheckInterval = setInterval(async () => {
                if (channels[currentChannelIndex] === channel && currentPlayerType === 'youtube') {
                    const liveResult = await checkChannelLiveStream(channelId);
                    
                    if (liveResult.isLive && !isInLiveMode) {
                        console.log('üî¥ Live detectada! Mudando para transmiss√£o ao vivo:', liveResult.title);
                        isInLiveMode = true;
                        loadYouTubePlayer(liveResult.url, channel, true);
                    } else if (!liveResult.isLive && isInLiveMode) {
                        console.log('üì∫ Live terminou! Retornando √† playlist do canal');
                        isInLiveMode = false;
                        const channelInfo = channelData.get(channel.number);
                        if (channelInfo) {
                            // Volta para o primeiro v√≠deo ap√≥s a live
                            channelInfo.currentVideoIndex = 0;
                            playChannelVideo(channel, channelInfo);
                        }
                    }
                }
            }, 60000); // Verifica a cada 1 minuto
        }

        // ========== CARREGAMENTO DE V√çDEO COM CLAPPR ==========
        function loadVideoChannel(channel) {
            const placeholder = document.getElementById('videoPlaceholder');
            
            if (channel.url.endsWith(".m3u8")) {
                placeholder.style.display = 'flex';
                placeholder.innerHTML = '<div class="loading-spinner"></div>';
                clapprContainer.style.display = 'block';
                alternativeContainer.style.display = 'none';
                
                try {
                    currentPlayer = new Clappr.Player({
                        source: channel.url,
                        parentId: "#clappr",
                        width: '100%',
                        height: '100%',
                        autoPlay: !deviceInfo.isMobile,
                        muted: deviceInfo.isMobile,
                        chromeless: false,
                        hideMediaControl: false,
                        hideVolumeBar: false,
                        disableKeyboardShortcuts: true,
                        disableVideoTagContextMenu: true,
                        watermark: false,
                        watermarkLink: false,
                        mobileUI: deviceInfo.isMobile,
                        playback: {
                            playInline: true,
                            recycleVideo: true,
                            hlsjsConfig: {
                                enableWorker: true,
                                maxBufferLength: deviceInfo.isMobile ? 20 : 30,
                                maxMaxBufferLength: deviceInfo.isMobile ? 300 : 600,
                                liveSyncDurationCount: 3,
                                enableSoftwareAES: deviceInfo.isIOS
                            }
                        },
                        poster: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iIzFhMWEzYSIvPjwvc3ZnPg==',
                        mediacontrol: {
                            seekbar: "#ff6b35",
                            buttons: "#fff"
                        },
                        events: {
                            onError: function(error) {
                                console.error('Erro no Clappr:', error);
                                loadWithAlternativePlayer(channel);
                            },
                            onPlay: function() {
                                isPlaying = true;
                                updateChannelInfo(channel);
                                requestWakeLock();
                                // Inicia monitor ap√≥s play
                                setTimeout(() => {
                                    startPersistentControlMonitor();
                                }, 5000);
                            },
                            onPause: function() {
                                isPlaying = false;
                                updateChannelInfo(channel);
                                releaseWakeLock();
                            },
                            onReady: function() {
                                console.log('Player Clappr pronto para ' + channel.name);
                                placeholder.style.display = 'none';
                                currentPlayerType = 'clappr';
                                
                                // Implementa o auto-hide dos controles + sistema anti-reativa√ß√£o
                                enhanceClapprPlayer();
                                setupClapprControlSuppressor();
                                
                                if (deviceInfo.isMobile && !currentPlayer.isPlaying()) {
                                    currentPlayer.play();
                                }
                            }
                        }
                    });
                } catch (error) {
                    console.error('Erro ao inicializar Clappr:', error);
                    loadWithAlternativePlayer(channel);
                }
            } else {
                loadWithAlternativePlayer(channel);
            }
        }

        // ========== FUN√á√ÉO ROBUSTA PARA ESCONDER CONTROLES DO CLAPPR ==========
        function hidePlayerControls() {
            // Estrat√©gia 1: Aplicar classe CSS que for√ßa esconder
            const clapprContainer = document.getElementById('clappr');
            if (clapprContainer) {
                clapprContainer.classList.add('clappr-controls-hidden', 'auto-hide-controls');
            }

            // Estrat√©gia 2: Seletores espec√≠ficos do Clappr
            const clapprSelectors = [
                '.media-control',
                '.media-control-background', 
                '.media-control-layer',
                '.media-control-center-panel',
                '.media-control-left-panel', 
                '.media-control-right-panel',
                '.media-control-bar',
                '.media-control-bar-container',
                '[data-media-control]',
                '.play-pause',
                '.stop-button',
                '.live-indicator',
                '.volume-icon', 
                '.volume-bar',
                '.progress-bar',
                '.seekbar',
                '.time-indicator',
                '.fullscreen',
                '.drawer-icon',
                '.level-selector',
                '.click-to-pause',
                '.spinner-three-bounce'
            ];

            // Estrat√©gia 3: Fun√ß√£o para esconder elementos
            const hideElements = () => {
                clapprSelectors.forEach(selector => {
                    // Busca no container do Clappr especificamente
                    const elements = document.querySelectorAll(`#clappr ${selector}, .player-wrapper ${selector}`);
                    elements.forEach(el => {
                        if (el) {
                            el.style.opacity = '0';
                            el.style.visibility = 'hidden';
                            el.style.pointerEvents = 'none';
                            el.style.transition = 'opacity 0.8s ease';
                            el.classList.add('hide');
                            
                            // Esconde completamente ap√≥s fade
                            setTimeout(() => {
                                if (el) {
                                    el.style.display = 'none';
                                }
                            }, 1000);
                        }
                    });
                });
            };

            // Estrat√©gia 4: Observer mais robusto
            const observer = new MutationObserver((mutations) => {
                let shouldHide = false;
                mutations.forEach(mutation => {
                    if (mutation.addedNodes.length > 0) {
                        shouldHide = true;
                    }
                });
                
                if (shouldHide) {
                    setTimeout(hideElements, 100);
                }
            });

            // Observa mudan√ßas no container do Clappr
            if (clapprContainer) {
                observer.observe(clapprContainer, {
                    childList: true,
                    subtree: true,
                    attributes: true,
                    attributeFilter: ['class', 'style']
                });
            }

            // Estrat√©gia 5: Execu√ß√£o imediata e repetida
            hideElements(); // Executa imediatamente
            setTimeout(hideElements, 500);  // Ap√≥s 0.5s
            setTimeout(hideElements, 1000); // Ap√≥s 1s
            setTimeout(hideElements, 2000); // Ap√≥s 2s
            setTimeout(hideElements, 3000); // Ap√≥s 3s
            setTimeout(hideElements, 5000); // Ap√≥s 5s

            // Estrat√©gia 6: Verifica√ß√£o cont√≠nua por 30 segundos
            let checkCount = 0;
            const checkInterval = setInterval(() => {
                hideElements();
                checkCount++;
                
                // Para ap√≥s 30 verifica√ß√µes (30 segundos)
                if (checkCount >= 30) {
                    clearInterval(checkInterval);
                    observer.disconnect();
                }
            }, 1000);

            // Estrat√©gia 7: CSS injection direto
            const style = document.createElement('style');
            style.textContent = `
                #clappr .media-control,
                #clappr [data-media-control],
                #clappr .media-control-background,
                #clappr .media-control-layer,
                #clappr .media-control-center-panel,
                #clappr .media-control-left-panel,
                #clappr .media-control-right-panel,
                #clappr .media-control-bar {
                    animation: fadeOutControls 1s ease 3s forwards !important;
                }
                
                @keyframes fadeOutControls {
                    0% { opacity: 1; }
                    100% { 
                        opacity: 0 !important; 
                        visibility: hidden !important;
                        display: none !important;
                    }
                }
            `;
            document.head.appendChild(style);

            console.log('üéÆ Sistema de auto-hide ativado para controles do Clappr');
        }

        function enhanceClapprPlayer() {
            if (currentPlayer && typeof currentPlayer.on === 'function') {
                // Evento quando player est√° pronto
                currentPlayer.on(Clappr.Events.PLAYER_READY, () => {
                    console.log('üé¨ Player Clappr pronto - aplicando auto-hide dos controles');
                    
                    // Aguarda um pouco para garantir que os elementos foram criados
                    setTimeout(() => {
                        hidePlayerControls();
                    }, 1000);
                });
                
                // Evento quando reprodu√ß√£o come√ßa
                currentPlayer.on(Clappr.Events.PLAYER_PLAY, () => {
                    console.log('‚ñ∂Ô∏è Reprodu√ß√£o iniciada - escondendo controles em 3 segundos');
                    setTimeout(() => {
                        hidePlayerControls();
                    }, 3000);
                });

                // Evento quando player carrega
                currentPlayer.on(Clappr.Events.PLAYER_LOADEDDATA, () => {
                    console.log('üìº Dados carregados - preparando auto-hide');
                    setTimeout(() => {
                        hidePlayerControls();
                    }, 2000);
                });

                // For√ßa esconder ap√≥s qualquer evento de timeline
                currentPlayer.on(Clappr.Events.PLAYER_TIMEUPDATE, () => {
                    // Aplica apenas uma vez ap√≥s come√ßar a reproduzir
                    if (isPlaying && !currentPlayer._hideControlsApplied) {
                        currentPlayer._hideControlsApplied = true;
                        setTimeout(() => {
                            hidePlayerControls();
                            startPersistentControlMonitor(); // Inicia monitor persistente
                        }, 4000);
                    }
                });

            } else {
                // Fallback se eventos n√£o estiverem dispon√≠veis
                console.log('‚ö†Ô∏è Eventos do Clappr n√£o dispon√≠veis - usando fallback');
                setTimeout(() => {
                    hidePlayerControls();
                    startPersistentControlMonitor();
                }, 3000);
            }
        }

        // ========== SISTEMA ANTI-REATIVA√á√ÉO DOS CONTROLES ==========
        function setupClapprControlSuppressor() {
            const clapprContainer = document.getElementById('clappr');
            if (!clapprContainer) return;

            let suppressorActive = false;

            // Ativa o suppressor ap√≥s 5 segundos de reprodu√ß√£o
            const activateSuppressor = () => {
                suppressorActive = true;
                console.log('üîí Suppressor de controles ativado');
                
                // For√ßa esconder controles a cada 2 segundos
                const forceHideInterval = setInterval(() => {
                    if (suppressorActive && isPlaying) {
                        const clapprContainer = document.getElementById('clappr');
                        if (clapprContainer) {
                            clapprContainer.classList.add('clappr-controls-hidden', 'auto-hide-controls');
                            
                            // For√ßa esconder elementos que podem ter reaparecido
                            const visibleControls = clapprContainer.querySelectorAll('.media-control:not(.hide), [data-media-control]:not(.hide)');
                            visibleControls.forEach(el => {
                                el.style.opacity = '0';
                                el.style.visibility = 'hidden';
                                el.style.display = 'none';
                                el.classList.add('hide');
                            });
                        }
                    } else {
                        clearInterval(forceHideInterval);
                    }
                }, 2000);

                // Desativa suppressor ap√≥s 60 segundos
                setTimeout(() => {
                    suppressorActive = false;
                    clearInterval(forceHideInterval);
                    console.log('üîì Suppressor de controles desativado');
                }, 60000);
            };

            // Intercepta eventos que podem reativar controles
            const interceptEvents = ['mousemove', 'mouseenter', 'mouseover', 'click', 'touchstart', 'touchmove'];
            
            interceptEvents.forEach(eventType => {
                clapprContainer.addEventListener(eventType, (e) => {
                    if (suppressorActive && isPlaying) {
                        // Permite o evento, mas for√ßa esconder controles logo ap√≥s
                        setTimeout(() => {
                            hidePlayerControls();
                        }, 100);
                    }
                }, { passive: true });
            });

            // Ativa o suppressor ap√≥s 5 segundos
            setTimeout(activateSuppressor, 5000);
        }

        // ========== MONITOR PERSISTENTE DE CONTROLES (√öLTIMA LINHA DE DEFESA) ==========
        function startPersistentControlMonitor() {
            let monitorActive = false;
            let monitorInterval;

            const startMonitoring = () => {
                if (monitorActive) return;
                
                monitorActive = true;
                console.log('üëÅÔ∏è Monitor persistente de controles iniciado');

                monitorInterval = setInterval(() => {
                    if (currentPlayerType === 'clappr' && isPlaying) {
                        // Lista de todos os poss√≠veis seletores de controles do Clappr
                        const allControlSelectors = [
                            '#clappr .media-control',
                            '#clappr [data-media-control]',
                            '#clappr .media-control-background',
                            '#clappr .media-control-layer', 
                            '#clappr .media-control-center-panel',
                            '#clappr .media-control-left-panel',
                            '#clappr .media-control-right-panel',
                            '#clappr .media-control-bar',
                            '#clappr .play-pause',
                            '#clappr .stop-button',
                            '#clappr .volume-icon',
                            '#clappr .volume-bar',
                            '#clappr .seekbar',
                            '#clappr .progress-bar',
                            '#clappr .time-indicator',
                            '#clappr .fullscreen',
                            '#clappr .drawer-icon',
                            '#clappr .live-indicator',
                            '.player-wrapper .media-control',
                            '.player-wrapper [data-media-control]'
                        ];

                        // Verifica cada seletor e for√ßa esconder
                        allControlSelectors.forEach(selector => {
                            const elements = document.querySelectorAll(selector);
                            elements.forEach(el => {
                                // S√≥ atua se o elemento estiver vis√≠vel
                                if (el && (el.style.display !== 'none' || el.style.opacity !== '0' || el.style.visibility !== 'hidden')) {
                                    el.style.setProperty('opacity', '0', 'important');
                                    el.style.setProperty('visibility', 'hidden', 'important');
                                    el.style.setProperty('display', 'none', 'important');
                                    el.style.setProperty('pointer-events', 'none', 'important');
                                    el.classList.add('hide');
                                    
                                    // Adiciona classes CSS que for√ßam esconder
                                    const parent = el.closest('#clappr, .player-wrapper');
                                    if (parent) {
                                        parent.classList.add('clappr-controls-hidden', 'auto-hide-controls');
                                    }
                                }
                            });
                        });
                    }
                }, 1500); // Verifica a cada 1.5 segundos

                // Para o monitor ap√≥s 2 minutos
                setTimeout(() => {
                    monitorActive = false;
                    if (monitorInterval) {
                        clearInterval(monitorInterval);
                        console.log('üëÅÔ∏è Monitor persistente finalizado');
                    }
                }, 120000);
            };

            // Inicia monitor quando o player come√ßar a reproduzir
            if (currentPlayerType === 'clappr' && isPlaying) {
                setTimeout(startMonitoring, 3000);
            }
        }

        // ========== YOUTUBE CHANNEL FUNCTIONS (VIDEOS ESPEC√çFICOS) ==========
        async function fetchChannelVideos(channelId) {
            if (!YOUTUBE_API_KEY || YOUTUBE_API_KEY === 'AIzaSyCNL4lsOgLRiRj1jc_5c0OVTK_E85ChVMc') {
                console.log('API Key do YouTube n√£o configurada, usando apenas v√≠deo original');
                return [];
            }
            
            try {
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${channelId}&type=video&order=date&maxResults=50&key=${YOUTUBE_API_KEY}`
                );
                
                if (!response.ok) {
                    throw new Error('Erro ao buscar v√≠deos do canal');
                }
                
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    return data.items.map(item => ({
                        videoId: item.id.videoId,
                        title: item.snippet.title,
                        publishedAt: item.snippet.publishedAt
                    }));
                }
                
                return [];
            } catch (error) {
                console.error('Erro ao buscar v√≠deos do canal:', error);
                return [];
            }
        }

        async function getChannelIdFromVideo(videoId) {
            if (!YOUTUBE_API_KEY || YOUTUBE_API_KEY === 'AIzaSyCNL4lsOgLRiRj1jc_5c0OVTK_E85ChVMc') {
                return null;
            }
            
            try {
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/videos?part=snippet&id=${videoId}&key=${YOUTUBE_API_KEY}`
                );
                
                if (!response.ok) {
                    throw new Error('Erro ao obter informa√ß√µes do v√≠deo');
                }
                
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    return data.items[0].snippet.channelId;
                }
                
                return null;
            } catch (error) {
                console.error('Erro ao obter ID do canal:', error);
                return null;
            }
        }

        async function loadYouTubePlaylist(channel) {
            const videoIdMatch = channel.url.match(/(?:youtu\.be\/|youtube\.com.*v=)([^&\n?#]+)/);
            if (!videoIdMatch) return [];
            
            const originalVideoId = videoIdMatch[1];
            const channelId = await getChannelIdFromVideo(originalVideoId);
            
            if (!channelId) {
                console.log('N√£o foi poss√≠vel obter ID do canal, usando apenas v√≠deo original');
                return [{ videoId: originalVideoId, title: channel.name, isOriginal: true }];
            }
            
            const videos = await fetchChannelVideos(channelId);
            
            const originalExists = videos.some(v => v.videoId === originalVideoId);
            if (!originalExists) {
                videos.unshift({ videoId: originalVideoId, title: channel.name, isOriginal: true });
            } else {
                const originalVideo = videos.find(v => v.videoId === originalVideoId);
                if (originalVideo) {
                    originalVideo.isOriginal = true;
                }
            }
            
            console.log(`Playlist carregada para ${channel.name}: ${videos.length} v√≠deos`);
            return videos;
        }

        async function checkYouTubeLive(videoId, channel) {
            try {
                const videoResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/videos?part=snippet&id=${videoId}&key=${YOUTUBE_API_KEY}`
                );
                
                if (!videoResponse.ok) {
                    throw new Error('Erro ao buscar informa√ß√µes do v√≠deo');
                }
                
                const videoData = await videoResponse.json();
                
                if (!videoData.items || videoData.items.length === 0) {
                    throw new Error('V√≠deo n√£o encontrado');
                }
                
                const channelId = videoData.items[0].snippet.channelId;
                
                const searchResponse = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${channelId}&type=video&eventType=live&key=${YOUTUBE_API_KEY}`
                );
                
                if (!searchResponse.ok) {
                    throw new Error('Erro ao buscar lives');
                }
                
                const searchData = await searchResponse.json();
                
                if (searchData.items && searchData.items.length > 0) {
                    const liveVideoId = searchData.items[0].id.videoId;
                    return {
                        isLive: true,
                        videoId: liveVideoId,
                        url: `https://www.youtube.com/watch?v=${liveVideoId}`
                    };
                }
                
                return { isLive: false };
            } catch (error) {
                console.log('Erro ao verificar live do YouTube:', error);
                return { isLive: false };
            }
        }

        function startLiveMonitoring(channel) {
            if (!YOUTUBE_API_KEY || YOUTUBE_API_KEY === 'AIzaSyCNL4lsOgLRiRj1jc_5c0OVTK_E85ChVMc') {
                return;
            }
            
            if (liveCheckInterval) {
                clearInterval(liveCheckInterval);
            }
            
            const videoIdMatch = channel.url.match(/(?:youtu\.be\/|youtube\.com.*v=)([^&\n?#]+)/);
            if (!videoIdMatch) return;
            
            const channelOriginalVideoId = videoIdMatch[1];
            
            liveCheckInterval = setInterval(async () => {
                if (channels[currentChannelIndex] === channel && currentPlayerType === 'youtube') {
                    const liveResult = await checkYouTubeLive(channelOriginalVideoId, channel);
                    
                    if (liveResult.isLive && !isInLiveMode) {
                        console.log('Live detectada! Mudando para transmiss√£o ao vivo');
                        isInLiveMode = true;
                        loadYouTubePlayer(liveResult.url, channel, true);
                    } else if (!liveResult.isLive && isInLiveMode) {
                        console.log('Live terminou! Retornando √† playlist');
                        isInLiveMode = false;
                        const playlist = channelPlaylists.get(channel.number) || [];
                        const originalIndex = playlist.findIndex(v => v.isOriginal);
                        currentVideoIndex = originalIndex >= 0 ? originalIndex : 0;
                        playCurrentVideo(channel);
                    }
                }
            }, 120000);
        }

        function stopLiveMonitoring() {
            if (liveCheckInterval) {
                clearInterval(liveCheckInterval);
                liveCheckInterval = null;
            }
        }

        async function loadYouTubeChannel(channel) {
            const placeholder = document.getElementById('videoPlaceholder');
            
            stopLiveMonitoring();
            isInLiveMode = false;
            
            const videoIdMatch = channel.url.match(/(?:youtu\.be\/|youtube\.com.*v=)([^&\n?#]+)/);
            if (videoIdMatch) {
                const videoId = videoIdMatch[1];
                originalVideoId = videoId;
                
                if (!channelPlaylists.has(channel.number)) {
                    placeholder.style.display = 'flex';
                    placeholder.innerHTML = '<div class="loading-spinner"></div><p style="margin-top: 10px;">Carregando playlist do canal...</p>';
                    
                    const playlist = await loadYouTubePlaylist(channel);
                    channelPlaylists.set(channel.number, playlist);
                    
                    const originalIndex = playlist.findIndex(v => v.isOriginal);
                    currentVideoIndex = originalIndex >= 0 ? originalIndex : 0;
                } else {
                    const playlist = channelPlaylists.get(channel.number);
                    const originalIndex = playlist.findIndex(v => v.isOriginal);
                    currentVideoIndex = originalIndex >= 0 ? originalIndex : 0;
                }
                
                if (YOUTUBE_API_KEY && YOUTUBE_API_KEY !== 'AIzaSyCNL4lsOgLRiRj1jc_5c0OVTK_E85ChVMc') {
                    const liveResult = await checkYouTubeLive(videoId, channel);
                    if (liveResult.isLive) {
                        console.log('Live detectada, transmitindo ao vivo:', liveResult.url);
                        isInLiveMode = true;
                        loadYouTubePlayer(liveResult.url, channel, true);
                        startLiveMonitoring(channel);
                        return;
                    }
                }
                
                playCurrentVideo(channel);
                startLiveMonitoring(channel);
            } else {
                showError(channel);
            }
        }

        function playCurrentVideo(channel) {
            const playlist = channelPlaylists.get(channel.number);
            if (!playlist || playlist.length === 0) {
                showError(channel);
                return;
            }
            
            const currentVideo = playlist[currentVideoIndex];
            if (!currentVideo) {
                currentVideoIndex = 0;
                playCurrentVideo(channel);
                return;
            }
            
            const videoUrl = `https://www.youtube.com/watch?v=${currentVideo.videoId}`;
            console.log(`Reproduzindo v√≠deo ${currentVideoIndex + 1}/${playlist.length}: ${currentVideo.title}`);
            
            loadYouTubePlayer(videoUrl, channel, false, () => {
                setTimeout(() => {
                    if (!isInLiveMode && channels[currentChannelIndex] === channel) {
                        nextVideoInPlaylist(channel);
                    }
                }, 1000);
            });
        }

        function nextVideoInPlaylist(channel) {
            const playlist = channelPlaylists.get(channel.number);
            if (!playlist || playlist.length === 0) return;
            
            currentVideoIndex++;
            
            if (currentVideoIndex >= playlist.length) {
                currentVideoIndex = 0;
                console.log('Fim da playlist, reiniciando do primeiro v√≠deo');
            }
            
            setTimeout(() => {
                if (!isInLiveMode && channels[currentChannelIndex] === channel) {
                    playCurrentVideo(channel);
                }
            }, 2000);
        }

        function loadYouTubePlayer(url, channel, isLive, onVideoEnd = null) {
            const placeholder = document.getElementById('videoPlaceholder');
            const videoIdMatch = url.match(/(?:youtu\.be\/|youtube\.com.*v=)([^&\n?#]+)/);
            
            if (videoIdMatch) {
                const videoId = videoIdMatch[1];
                
                placeholder.style.display = 'none';
                clapprContainer.style.display = 'block';
                alternativeContainer.style.display = 'none';
                
                const liveParams = isLive ? '&live=1' : '';
                const hdParams = '&vq=hd720';
                
                clapprContainer.innerHTML = `
                    <iframe 
                        id="ytplayer"
                        width="100%" 
                        height="100%" 
                        src="https://www.youtube.com/embed/${videoId}?autoplay=1&playsinline=1&controls=1&rel=0&modestbranding=1&enablejsapi=1&quality=hd720${liveParams}${hdParams}"
                        frameborder="0"
                        allow="autoplay; encrypted-media; fullscreen"
                        allowfullscreen
                        style="border-radius:10px;">
                    </iframe>
                `;
                
                currentPlayer = { 
                    type: 'youtube', 
                    videoId: videoId, 
                    isLive: isLive,
                    onVideoEnd: onVideoEnd
                };
                currentPlayerType = 'youtube';
                isPlaying = true;
                updateChannelInfo(channel);
                
                setupYouTubeEventListener(onVideoEnd);
                
                if (isLive) {
                    const originalName = channel.name;
                    document.getElementById('currentChannelName').textContent = `üî¥ ${originalName} (AO VIVO)`;
                    document.getElementById('fsChannelName').textContent = `üî¥ ${originalName} (AO VIVO)`;
                } else {
                    const playlist = channelPlaylists.get(channel.number);
                    if (playlist && playlist.length > 1) {
                        const currentVideo = playlist[currentVideoIndex];
                        const playlistInfo = ` (${currentVideoIndex + 1}/${playlist.length})`;
                        document.getElementById('currentChannelName').textContent = channel.name + playlistInfo;
                        document.getElementById('fsChannelName').textContent = channel.name + playlistInfo;
                    }
                }
            }
        }

        function setupYouTubeEventListener(onVideoEnd) {
            if (window.youtubeEventListener) {
                window.removeEventListener('message', window.youtubeEventListener);
            }
            
            window.youtubeEventListener = function(e) {
                if (e.origin === 'https://www.youtube.com') {
                    try {
                        if (typeof e.data === 'string' && e.data.includes('event')) {
                            const data = JSON.parse(e.data);
                            if (data.event === 'onStateChange') {
                                switch(data.info) {
                                    case 0:
                                        console.log('V√≠deo do YouTube terminou');
                                        isPlaying = false;
                                        releaseWakeLock();
                                        if (onVideoEnd && !isInLiveMode) {
                                            onVideoEnd();
                                        }
                                        break;
                                    case 1:
                                        isPlaying = true;
                                        requestWakeLock();
                                        setTimeout(() => {
                                            setYouTubeQuality('hd720');
                                        }, 2000);
                                        break;
                                    case 2:
                                        isPlaying = false;
                                        releaseWakeLock();
                                        break;
                                }
                                if (channels[currentChannelIndex]) {
                                    updateChannelInfo(channels[currentChannelIndex]);
                                }
                            }
                        }
                    } catch (error) {
                        // Ignora erros de parsing
                    }
                }
            };
            
            window.addEventListener('message', window.youtubeEventListener);
        }

        function setYouTubeQuality(quality) {
            const iframe = document.getElementById('ytplayer');
            if (iframe) {
                try {
                    iframe.contentWindow.postMessage(
                        `{"event":"command","func":"setPlaybackQuality","args":["${quality}"]}`, 
                        '*'
                    );
                    console.log(`Qualidade definida para: ${quality}`);
                } catch (e) {
                    console.log('N√£o foi poss√≠vel definir qualidade:', e);
                }
            }
        }

        // ========== CARREGAMENTO DE CANAL DE √ÅUDIO ==========
        function loadAudioChannel(channel) {
            const placeholder = document.getElementById('videoPlaceholder');
            
            placeholder.style.display = 'none';
            clapprContainer.style.display = 'none';
            alternativeContainer.style.display = 'none';
            
            audioVisualizerEl.classList.add('active');
            document.getElementById('audioChannelName').textContent = channel.name;
            document.getElementById('audioChannelDesc').textContent = `Canal ${channel.number} - Streaming de √Åudio`;
            
            const audio = document.createElement('audio');
            audio.src = channel.url;
            audio.autoplay = true;
            audio.controls = false;
            audio.crossOrigin = 'anonymous';
            
            audio.addEventListener('play', () => {
                isPlaying = true;
                updateChannelInfo(channel);
                requestWakeLock();
            });
            
            audio.addEventListener('pause', () => {
                isPlaying = false;
                updateChannelInfo(channel);
                releaseWakeLock();
            });
            
            audio.addEventListener('error', (e) => {
                console.error('Erro no √°udio:', e);
                showError(channel);
            });
            
            currentPlayer = audio;
            currentPlayerType = 'audio';
            
            audio.play().catch(e => {
                console.error('Erro ao reproduzir √°udio:', e);
                showError(channel);
            });
        }

        // ========== PLAYER ALTERNATIVO ==========
        function loadWithAlternativePlayer(channel) {
            const placeholder = document.getElementById('videoPlaceholder');
            
            placeholder.style.display = 'flex';
            placeholder.innerHTML = '<div class="loading-spinner"></div>';
            clapprContainer.style.display = 'none';
            alternativeContainer.style.display = 'block';
            
            const isVideoFile = /\.(mp4|webm|ogg|avi|mkv|mov)(\?.*)?$/i.test(channel.url);
            const isAudioFile = /\.(mp3|wav|ogg|aac|m4a|flac)(\?.*)?$/i.test(channel.url);
            
            let element;
            if (isVideoFile || channel.url.includes('m3u8')) {
                element = document.createElement('video');
                element.controls = true;
                element.style.width = '100%';
                element.style.height = '100%';
                element.style.borderRadius = '10px';
            } else {
                loadAudioChannel(channel);
                return;
            }
            
            element.src = channel.url;
            element.autoplay = !deviceInfo.isMobile;
            element.muted = deviceInfo.isMobile;
            element.playsInline = true;
            element.crossOrigin = 'anonymous';
            
            element.addEventListener('loadstart', () => {
                console.log('Carregando com player alternativo...');
            });
            
            element.addEventListener('canplay', () => {
                placeholder.style.display = 'none';
                currentPlayerType = 'alternative';
            });
            
            element.addEventListener('play', () => {
                isPlaying = true;
                updateChannelInfo(channel);
                requestWakeLock();
            });
            
            element.addEventListener('pause', () => {
                isPlaying = false;
                updateChannelInfo(channel);
                releaseWakeLock();
            });
            
            element.addEventListener('error', (e) => {
                console.error('Erro no player alternativo:', e);
                showError(channel);
            });
            
            alternativeContainer.innerHTML = '';
            alternativeContainer.appendChild(element);
            currentPlayer = element;
            
            element.play().catch(e => {
                console.error('Erro ao reproduzir com player alternativo:', e);
            });
        }

        // ========== LIMPEZA DE PLAYERS ==========
        function cleanupPlayers() {
            stopLiveMonitoring();
            isInLiveMode = false;
            
            if (window.youtubeEventListener) {
                window.removeEventListener('message', window.youtubeEventListener);
                window.youtubeEventListener = null;
            }
            
            if (currentPlayer) {
                if (currentPlayerType === 'clappr' && currentPlayer.destroy) {
                    currentPlayer.destroy();
                } else if (currentPlayerType === 'alternative' || currentPlayerType === 'audio') {
                    if (currentPlayer.pause) currentPlayer.pause();
                }
                currentPlayer = null;
            }
            
            currentPlayerType = null;
            clapprContainer.innerHTML = '';
            alternativeContainer.innerHTML = '';
        }

        // ========== MOSTRAR ERRO ==========
        function showError(channel) {
            const placeholder = document.getElementById('videoPlaceholder');
            
            cleanupPlayers();
            audioVisualizerEl.classList.remove('active');
            
            clapprContainer.style.display = 'none';
            alternativeContainer.style.display = 'none';
            placeholder.style.display = 'flex';
            placeholder.innerHTML = `
                <div style="text-align: center;">
                    <h3>‚ùå Erro ao carregar ${channel.name}</h3>
                    <p>Canal ${channel.number}</p>
                    <p style="margin-top: 10px; font-size: 0.9rem; color: #ccc;">
                        N√£o foi poss√≠vel carregar este canal.<br>
                        Tente novamente ou selecione outro canal.
                    </p>
                    <button class="control-btn" onclick="selectChannel(${currentChannelIndex})" style="margin-top: 20px;">
                        üîÑ Tentar Novamente
                    </button>
                </div>
            `;
        }

        // ========== CONTROLES DE FULLSCREEN APRIMORADOS PARA MOBILE ==========
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                // Verifica se √© dispositivo m√≥vel
                if (deviceInfo.isMobile) {
                    enterMobileFullscreen();
                } else {
                    // Desktop/TV - comportamento normal
                    const container = document.querySelector('.video-container');
                    if (container.requestFullscreen) {
                        container.requestFullscreen();
                    } else if (container.webkitRequestFullscreen) {
                        container.webkitRequestFullscreen();
                    } else if (container.mozRequestFullScreen) {
                        container.mozRequestFullScreen();
                    } else if (container.msRequestFullscreen) {
                        container.msRequestFullscreen();
                    }
                }
            } else {
                exitFullscreen();
            }
        }

        function enterMobileFullscreen() {
            console.log('üì± Entrando em fullscreen mobile com orienta√ß√£o vertical');
            
            const mainApp = document.getElementById('mainApp');
            const videoContainer = document.querySelector('.video-container');
            
            // Adiciona classe para fullscreen mobile
            mainApp.classList.add('mobile-fullscreen-active');
            document.body.classList.add('mobile-device');
            
            // Tenta for√ßar orienta√ß√£o vertical (portrait)
            try {
                // M√©todo 1: Screen Orientation API
                if (screen.orientation && screen.orientation.lock) {
                    screen.orientation.lock('portrait').then(() => {
                        console.log('‚úÖ Orienta√ß√£o travada em portrait');
                    }).catch(err => {
                        console.log('‚ö†Ô∏è N√£o foi poss√≠vel travar orienta√ß√£o:', err);
                        // Fallback: CSS transform
                        applyPortraitTransform();
                    });
                } else {
                    // Fallback: CSS transform
                    applyPortraitTransform();
                }
            } catch (err) {
                console.log('‚ö†Ô∏è Screen Orientation API n√£o dispon√≠vel, usando CSS');
                applyPortraitTransform();
            }

            // Entra em fullscreen nativo tamb√©m
            if (videoContainer.requestFullscreen) {
                videoContainer.requestFullscreen().catch(err => {
                    console.log('Fullscreen nativo n√£o dispon√≠vel:', err);
                });
            } else if (videoContainer.webkitRequestFullscreen) {
                videoContainer.webkitRequestFullscreen();
            } else if (videoContainer.mozRequestFullScreen) {
                videoContainer.mozRequestFullScreen();
            } else if (videoContainer.msRequestFullscreen) {
                videoContainer.msRequestFullscreen();
            }

            // Esconde barra de endere√ßo no mobile
            setTimeout(() => {
                window.scrollTo(0, 1);
            }, 100);
        }

        function applyPortraitTransform() {
            console.log('üîÑ Aplicando transforma√ß√£o CSS para portrait');
            
            const mainApp = document.getElementById('mainApp');
            
            // Detecta se est√° em landscape e for√ßa portrait
            if (window.innerWidth > window.innerHeight) {
                mainApp.style.transform = 'rotate(90deg)';
                mainApp.style.transformOrigin = 'center center';
                mainApp.style.width = '100vh';
                mainApp.style.height = '100vw';
                mainApp.style.position = 'fixed';
                mainApp.style.top = '0';
                mainApp.style.left = '0';
                mainApp.style.zIndex = '9999999';
                
                console.log('üîÑ Rota√ß√£o aplicada para simular portrait');
            }
        }

        function exitFullscreen() {
            console.log('üö™ Saindo do fullscreen');
            
            // Remove classes de fullscreen mobile
            const mainApp = document.getElementById('mainApp');
            mainApp.classList.remove('mobile-fullscreen-active');
            
            // Remove transforma√ß√µes CSS
            mainApp.style.transform = '';
            mainApp.style.transformOrigin = '';
            mainApp.style.width = '';
            mainApp.style.height = '';
            mainApp.style.position = '';
            mainApp.style.top = '';
            mainApp.style.left = '';
            mainApp.style.zIndex = '';

            // Destrava orienta√ß√£o
            try {
                if (screen.orientation && screen.orientation.unlock) {
                    screen.orientation.unlock();
                    console.log('üîì Orienta√ß√£o destravada');
                }
            } catch (err) {
                console.log('‚ö†Ô∏è N√£o foi poss√≠vel destravar orienta√ß√£o:', err);
            }

            // Sai do fullscreen nativo
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
            } else if (document.mozCancelFullScreen) {
                document.mozCancelFullScreen();
            } else if (document.msExitFullscreen) {
                document.msExitFullscreen();
            }
        }

        function isInFullscreen() {
            return !!(document.fullscreenElement || 
                     document.webkitFullscreenElement || 
                     document.mozFullScreenElement || 
                     document.msFullscreenElement);
        }

        // ========== FOCO EM CANAIS ==========
        function focusChannel(index) {
            if (index < 0 || index >= channels.length) return;
            
            try {
                const channelItems = document.querySelectorAll('.channel-item');
                if (channelItems.length === 0) {
                    console.warn('Nenhum canal encontrado para focar');
                    return;
                }
                
                channelItems.forEach(item => {
                    if (item && item.classList) {
                        item.classList.remove('focused');
                    }
                });
                
                if (channelItems[index] && channelItems[index].classList) {
                    channelItems[index].classList.add('focused');
                    channelItems[index].focus();
                    
                    focusedChannelIndex = index;
                    
                    channelItems[index].scrollIntoView({ block: 'nearest', behavior: 'smooth' });
                }
            } catch (error) {
                console.error('Erro ao focar canal:', error);
            }
        }

        // ========== NAVEGA√á√ÉO DE CANAIS ==========
        function nextChannel() {
            const nextIndex = (currentChannelIndex + 1) % channels.length;
            selectChannel(nextIndex);
        }

        function previousChannel() {
            const prevIndex = currentChannelIndex === 0 ? channels.length - 1 : currentChannelIndex - 1;
            selectChannel(prevIndex);
        }

        // ========== CONTROLES DE REPRODU√á√ÉO ==========
        function togglePlayPause() {
            if (!channels[currentChannelIndex]) return;
            
            switch(currentPlayerType) {
                case 'youtube':
                    const iframe = document.getElementById('ytplayer');
                    if (iframe) {
                        if (isPlaying) {
                            iframe.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}', '*');
                            isPlaying = false;
                        } else {
                            iframe.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}', '*');
                            isPlaying = true;
                        }
                        updateChannelInfo(channels[currentChannelIndex]);
                    }
                    break;
                    
                case 'clappr':
                    if (currentPlayer && currentPlayer.isPlaying) {
                        if (currentPlayer.isPlaying()) {
                            currentPlayer.pause();
                        } else {
                            currentPlayer.play();
                        }
                    }
                    break;
                    
                case 'alternative':
                case 'audio':
                    if (currentPlayer) {
                        if (currentPlayer.paused) {
                            currentPlayer.play();
                        } else {
                            currentPlayer.pause();
                        }
                    }
                    break;
                    
                default:
                    selectChannel(currentChannelIndex);
                    break;
            }
        }

        // ========== INFORMA√á√ïES DO CANAL ==========
        function showInfo() {
            if (channels[currentChannelIndex]) {
                updateChannelInfo(channels[currentChannelIndex]);
                
                if (isInFullscreen()) {
                    const fsInfo = document.getElementById('fullscreenInfo');
                    fsInfo.style.display = 'block';
                    fsInfo.style.visibility = 'visible';
                    fsInfo.style.opacity = '1';
                    fsInfo.style.zIndex = '2147483647';
                    
                    if (fullscreenInfoTimeout) clearTimeout(fullscreenInfoTimeout);
                    fullscreenInfoTimeout = setTimeout(() => {
                        hideInfo();
                    }, 7000);
                    
                    console.log('Mostrando info em fullscreen');
                } else {
                    infoPanel.style.display = 'block';
                }
            }
        }

        function hideInfo() {
            const infoPanel = document.getElementById('infoPanel');
            const fsInfo = document.getElementById('fullscreenInfo');
            
            if (infoPanel) {
                infoPanel.style.display = 'none';
            }
            
            if (fsInfo) {
                fsInfo.style.display = 'none';
                fsInfo.style.visibility = 'hidden';
                fsInfo.style.opacity = '0';
            }
            
            if (fullscreenInfoTimeout) {
                clearTimeout(fullscreenInfoTimeout);
                fullscreenInfoTimeout = null;
            }
        }

        function updateChannelInfo(channel) {
            const updateElements = (prefix) => {
                const nameEl = document.getElementById(`${prefix}ChannelName`);
                const numberEl = document.getElementById(`${prefix}ChannelNumber`);
                const statusEl = document.getElementById(`${prefix}ChannelStatus`);
                const typeEl = document.getElementById(`${prefix}ChannelType`);
                
                if (nameEl) nameEl.textContent = channel.name;
                if (numberEl) numberEl.textContent = channel.number;
                if (typeEl) {
                    switch(channel.type) {
                        case 'audio': typeEl.textContent = 'R√°dio/√Åudio'; break;
                        case 'youtube': typeEl.textContent = 'YouTube V√≠deo'; break;
                        case 'youtube_channel': typeEl.textContent = 'YouTube Canal'; break;
                        case 'video': typeEl.textContent = 'TV/V√≠deo'; break;
                        default: typeEl.textContent = 'Streaming'; break;
                    }
                }
                if (statusEl) {
                    if (channel.type === 'audio') {
                        statusEl.textContent = isPlaying ? 'Tocando' : 'Pausado';
                    } else {
                        statusEl.textContent = isPlaying ? 'Transmitindo ao vivo' : 'Pausado';
                    }
                }
            };
            
            updateElements('current');
            updateElements('channel');
            updateElements('fs');
        }

        // ========== ENTRADA DE N√öMEROS ==========
        function handleNumberInput(key) {
            numberInputBuffer += key;
            
            if (channelNumberDisplay) {
                channelNumberDisplay.textContent = numberInputBuffer;
                channelNumberDisplay.style.display = 'block';
            }

            if (numberInputTimeout) clearTimeout(numberInputTimeout);

            numberInputTimeout = setTimeout(() => {
                const channelNumber = parseInt(numberInputBuffer);
                const channelIndex = channels.findIndex(ch => ch.number === channelNumber);
                if (channelIndex !== -1) {
                    selectChannel(channelIndex);
                    focusChannel(channelIndex);
                }
                numberInputBuffer = "";
                
                if (channelNumberDisplay) {
                    setTimeout(() => {
                        channelNumberDisplay.style.display = 'none';
                    }, 500);
                }
            }, 1500);
        }

        // ========== CONTROLES DE TECLADO ==========
        function setupKeyboardControls() {
            const keyboardHandler = function(event) {
                const preventDefaultKeys = [
                    'ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 
                    'Enter', 'NumpadEnter', 'Space', 'KeyF', 'KeyI'
                ];
                
                if (event.code === 'Escape') {
                    if (isInFullscreen()) {
                        event.preventDefault();
                        event.stopPropagation();
                        hideInfo();
                        exitFullscreen();
                        return;
                    } else {
                        hideInfo();
                        return;
                    }
                }
                
                if (preventDefaultKeys.includes(event.code)) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                
                if (/^Digit[0-9]$/.test(event.code) || /^Numpad[0-9]$/.test(event.code)) {
                    event.preventDefault();
                    event.stopPropagation();
                    const digit = event.code.replace(/\D/g, '');
                    handleNumberInput(digit);
                    return;
                }
                
                switch(event.code) {
                    case 'ArrowUp':
                        const prevFocus = focusedChannelIndex === 0 ? channels.length - 1 : focusedChannelIndex - 1;
                        focusChannel(prevFocus);
                        break;
                        
                    case 'ArrowDown':
                        const nextFocus = (focusedChannelIndex + 1) % channels.length;
                        focusChannel(nextFocus);
                        break;
                        
                    case 'Enter':
                    case 'NumpadEnter':
                        selectChannel(focusedChannelIndex);
                        break;
                        
                    case 'ArrowLeft':
                        previousChannel();
                        break;
                        
                    case 'ArrowRight':
                        nextChannel();
                        break;
                        
                    case 'Space':
                        togglePlayPause();
                        break;
                        
                    case 'KeyF':
                        toggleFullscreen();
                        break;
                        
                    case 'KeyI':
                        if (fullscreenInfo.style.display === 'block') {
                            hideInfo();
                        } else {
                            showInfo();
                        }
                        break;
                }
            };
            
            document.addEventListener('keydown', keyboardHandler, true);
            window.addEventListener('keydown', keyboardHandler, true);
            
            document.addEventListener('fullscreenchange', function() {
                setTimeout(() => {
                    document.removeEventListener('keydown', keyboardHandler, true);
                    window.removeEventListener('keydown', keyboardHandler, true);
                    document.addEventListener('keydown', keyboardHandler, true);
                    window.addEventListener('keydown', keyboardHandler, true);
                }, 100);
            });
        }

        // ========== CONTROLES REMOTOS ==========
        function setupRemoteControls() {
            if (deviceInfo.isTV || deviceInfo.isRoku) {
                document.body.classList.add('smart-tv');
                
                const remoteHandler = function(event) {
                    if (event.keyCode >= 48 && event.keyCode <= 57) {
                        event.preventDefault();
                        event.stopPropagation();
                        const digit = String(event.keyCode - 48);
                        handleNumberInput(digit);
                        return;
                    }
                    
                    switch(event.keyCode) {
                        case 403: // Red
                            showInfo();
                            break;
                        case 404: // Green
                            togglePlayPause();
                            break;
                        case 405: // Yellow
                            toggleFullscreen();
                            break;
                        case 406: // Blue
                            focusChannel(0);
                            break;
                            
                        case 122: // F11
                        case 48: // ZOOM
                        case 220: // Aspect Ratio
                        case 174: // Volume Down
                            event.preventDefault();
                            event.stopPropagation();
                            toggleFullscreen();
                            break;
                            
                        case 457: // INFO
                        case 18: // ALT
                        case 36: // HOME
                        case 116: // F5
                            event.preventDefault();
                            event.stopPropagation();
                            showInfo();
                            break;
                            
                        case 10009: // Return/Back
                        case 8: // Backspace
                            if (isInFullscreen()) {
                                if (fullscreenInfo.style.display === 'block') {
                                    hideInfo();
                                } else {
                                    exitFullscreen();
                                }
                            } else {
                                hideInfo();
                            }
                            break;
                            
                        case 427: // Channel Up
                        case 33: // Page Up
                            nextChannel();
                            break;
                            
                        case 428: // Channel Down
                        case 34: // Page Down
                            previousChannel();
                            break;
                            
                        case 415: // Play
                        case 179: // Play/Pause
                            togglePlayPause();
                            break;
                            
                        case 19: // Pause
                        case 413: // Stop
                            if (currentPlayer) {
                                if (currentPlayerType === 'youtube') {
                                    const iframe = document.getElementById('ytplayer');
                                    if (iframe && isPlaying) {
                                        iframe.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}', '*');
                                        isPlaying = false;
                                    }
                                } else if (currentPlayer.pause) {
                                    currentPlayer.pause();
                                }
                            }
                            break;
                            
                        case 13: // Enter/OK
                        case 195: // OK
                            if (document.activeElement.classList.contains('channel-item')) {
                                const index = parseInt(document.activeElement.getAttribute('data-index'));
                                selectChannel(index);
                            }
                            break;
                    }
                };
                
                document.addEventListener('keydown', remoteHandler, true);
                window.addEventListener('keydown', remoteHandler, true);
            }
        }

        // ========== CONTROLES TOUCH ==========
        function setupTouchControls() {
            if (!deviceInfo.isTouchDevice) return;
            
            let touchStartX = 0;
            let touchStartY = 0;
            let touchEndX = 0;
            let touchEndY = 0;
            
            const videoContainer = document.querySelector('.video-container');
            
            if (videoContainer) {
                videoContainer.addEventListener('touchstart', function(e) {
                    touchStartX = e.changedTouches[0].screenX;
                    touchStartY = e.changedTouches[0].screenY;
                }, { passive: true });
                
                videoContainer.addEventListener('touchend', function(e) {
                    touchEndX = e.changedTouches[0].screenX;
                    touchEndY = e.changedTouches[0].screenY;
                    handleSwipe();
                }, { passive: true });
            }
            
            function handleSwipe() {
                const diffX = touchEndX - touchStartX;
                const diffY = touchEndY - touchStartY;
                const minSwipeDistance = 50;
                
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > minSwipeDistance) {
                    if (diffX > 0) {
                        previousChannel();
                    } else {
                        nextChannel();
                    }
                }
                
                if (Math.abs(diffY) > Math.abs(diffX) && Math.abs(diffY) > minSwipeDistance) {
                    if (diffY > 0) {
                        showInfo();
                    } else {
                        if (infoPanel.style.display === 'block') {
                            hideInfo();
                        } else {
                            toggleFullscreen();
                        }
                    }
                }
            }
            
            // Double tap para play/pause
            let lastTap = 0;
            videoContainer.addEventListener('touchend', function(e) {
                const currentTime = new Date().getTime();
                const tapLength = currentTime - lastTap;
                if (tapLength < 500 && tapLength > 0) {
                    e.preventDefault();
                    togglePlayPause();
                }
                lastTap = currentTime;
            });
        }

        // ========== WAKE LOCK ==========
        async function requestWakeLock() {
            try {
                if ('wakeLock' in navigator && !deviceInfo.isMobile) {
                    wakeLock = await navigator.wakeLock.request('screen');
                    console.log('Wake lock ativado');
                }
            } catch (err) {
                console.error('Erro ao ativar wake lock:', err);
            }
        }

        function releaseWakeLock() {
            if (wakeLock) {
                wakeLock.release();
                wakeLock = null;
            }
        }

        // ========== OVERLAY DO NOME DO CANAL ==========
        function showActiveChannelNameOverlay() {
            const overlay = document.createElement('div');
            overlay.id = 'channel-name-overlay';
            overlay.style.position = 'absolute';
            overlay.style.top = '10px';
            overlay.style.left = '10px';
            overlay.style.zIndex = '99999';
            overlay.style.color = 'rgba(255, 255, 255, 0.8)';
            overlay.style.fontSize = '1.2rem';
            overlay.style.fontWeight = 'bold';
            overlay.style.textShadow = '1px 1px 3px black';
            overlay.style.pointerEvents = 'none';
            overlay.style.transition = 'opacity 0.3s';
            overlay.style.display = 'none';
            
            const videoContainer = document.querySelector('.video-container');
            if (videoContainer) {
                videoContainer.appendChild(overlay);
            }
        }

        function updateChannelNameOverlay() {
            const overlay = document.getElementById('channel-name-overlay');
            const channel = channels[currentChannelIndex];
            if (channel && overlay) {
                overlay.textContent = channel.name;
                overlay.style.display = 'block';
                
                // Auto-hide ap√≥s 3 segundos
                setTimeout(() => {
                    if (overlay) {
                        overlay.style.opacity = '0';
                        setTimeout(() => {
                            if (overlay) overlay.style.display = 'none';
                        }, 300);
                    }
                }, 3000);
                
                // Reset opacity
                overlay.style.opacity = '1';
            }
        }

        // ========== EVENT LISTENERS ==========
        window.addEventListener('load', function() {
            setTimeout(() => {
                focusChannel(0);
                if (!currentPlayer && !isPlaying) {
                    console.log('Auto-start adicional executado...');
                    selectChannel(0);
                }
            }, 500);
        });

        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                if (!currentPlayer && !isPlaying) {
                    console.log('Garantia final de auto-start...');
                    selectChannel(0);
                }
            }, 5000);
        });

        // Event listeners para fullscreen e orienta√ß√£o
        document.addEventListener('fullscreenchange', handleFullscreenChange);
        document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
        document.addEventListener('mozfullscreenchange', handleFullscreenChange);
        document.addEventListener('MSFullscreenChange', handleFullscreenChange);

        // Event listeners para mudan√ßa de orienta√ß√£o
        window.addEventListener('orientationchange', handleOrientationChange);
        window.addEventListener('resize', handleOrientationChange);

        function handleFullscreenChange() {
            const isFullscreen = !!(document.fullscreenElement || 
                                   document.webkitFullscreenElement || 
                                   document.mozFullScreenElement || 
                                   document.msFullscreenElement);
            
            if (!isFullscreen) {
                hideInfo();
                // Se saiu de fullscreen, remove classes mobile
                const mainApp = document.getElementById('mainApp');
                mainApp.classList.remove('mobile-fullscreen-active');
                
                // Destrava orienta√ß√£o se for mobile
                if (deviceInfo.isMobile) {
                    try {
                        if (screen.orientation && screen.orientation.unlock) {
                            screen.orientation.unlock();
                        }
                    } catch (err) {
                        console.log('N√£o foi poss√≠vel destravar orienta√ß√£o:', err);
                    }
                }
            }
            
            console.log('üì∫ Fullscreen mudou:', isFullscreen);
        }

        function handleOrientationChange() {
            // Aguarda um pouco para a orienta√ß√£o estabilizar
            setTimeout(() => {
                const mainApp = document.getElementById('mainApp');
                
                // Se est√° em fullscreen mobile e mudou para landscape, for√ßa portrait novamente
                if (deviceInfo.isMobile && 
                    mainApp.classList.contains('mobile-fullscreen-active') && 
                    window.innerWidth > window.innerHeight) {
                    
                    console.log('üì± Detectada mudan√ßa para landscape em fullscreen mobile - for√ßando portrait');
                    applyPortraitTransform();
                }
            }, 100);
        }

    </script>

    <!-- 
    ========================================
    üé¨ SISTEMA AVAN√áADO DE CANAIS YOUTUBE IMPLEMENTADO
    ========================================
    
    FUNCIONALIDADES IMPLEMENTADAS:
    
    üî∏ SUPORTE A TODAS AS ESTRUTURAS DE URL:
    - https://www.youtube.com/@Handle
    - https://www.youtube.com/channel/ID_DO_CANAL
    - https://www.youtube.com/c/NOME_PERSONALIZADO
    - https://www.youtube.com/NOME_PERSONALIZADO
    - https://www.youtube.com/user/USERNAME
    - URLs de v√≠deos espec√≠ficos (mant√©m compatibilidade)
    
    üî∏ DETEC√á√ÉO AUTOM√ÅTICA DE LIVES:
    - Verifica a cada 1 minuto se h√° transmiss√£o ao vivo
    - Prioriza live sobre v√≠deos gravados
    - Retorna automaticamente aos v√≠deos ap√≥s live terminar
    
    üî∏ SISTEMA DE PLAYLIST INFINITA:
    - Busca os 50 v√≠deos mais recentes do canal
    - Loop infinito: ap√≥s √∫ltimo v√≠deo, volta ao primeiro
    - Reprodu√ß√£o autom√°tica sequencial
    - Cache inteligente dos dados do canal
    
    üî∏ MONITORAMENTO INTELIGENTE:
    - Verifica√ß√£o cont√≠nua de lives ativas
    - Transi√ß√£o suave entre live e v√≠deos
    - Mant√©m posi√ß√£o na playlist ap√≥s live
    
    üî∏ COMPATIBILIDADE TOTAL:
    - Funciona com API configurada (recursos completos)
    - Funciona sem API (modo b√°sico)
    - Mant√©m funcionalidade de v√≠deos espec√≠ficos
    - Sistema de fallback robusto
    
    COMO USAR:
    1. Configure channels[] com type: "youtube_channel"
    2. URL pode ser qualquer formato do YouTube
    3. Adicione liveMode: true para priorizar lives
    4. Sistema detecta automaticamente o tipo de conte√∫do
    
    EXEMPLOS NA LISTA DE CANAIS:
    - Canal 40: CaZ√© TV (URL de canal com live mode)
    - Canal 61: CNN Brasil (URL de canal)
    - Canal 64: Record News (URL de canal)
    - Canal 90: TV Can√ß√£o Nova (URL de canal)
	
# 1. Para Canal Completo:

{ number: X, name: "Nome do Canal", url: "https://www.youtube.com/@handle", type: "youtube_channel" }

#2. Para V√≠deo Espec√≠fico:

{ number: X, name: "Nome", url: "https://www.youtube.com/watch?v=ID", type: "youtube" }

# 3. Para Canal com Prioridade de Live:

{ number: X, name: "Canal", url: "https://www.youtube.com/@handle", type: "youtube_channel", liveMode: true }
    ========================================

    ========================================
    üéÆ SISTEMA ROBUSTO DE AUTO-HIDE DOS CONTROLES CLAPPR
    ========================================
    
    IMPLEMENTA√á√ÉO MULTI-CAMADAS PARA GARANTIR QUE OS CONTROLES SUMAM:
    
    üî∏ CAMADA 1 - CSS For√ßado:
    - Classes CSS com !important que for√ßam opacity: 0 e display: none
    - Anima√ß√µes CSS que fazem fade autom√°tico ap√≥s 3 segundos
    - Aplica√ß√£o de classes no container principal
    
    üî∏ CAMADA 2 - JavaScript Agressivo:
    - hidePlayerControls(): 7 estrat√©gias diferentes
    - Seletores espec√≠ficos do Clappr
    - MutationObserver robusto
    - Execu√ß√£o repetida em m√∫ltiplos intervals
    
    üî∏ CAMADA 3 - Sistema Anti-Reativa√ß√£o:
    - setupClapprControlSuppressor(): Intercepta eventos de mouse/touch
    - For√ßa esconder controles mesmo quando usu√°rio interage
    - Suppressor ativo por 60 segundos ap√≥s reprodu√ß√£o
    
    üî∏ CAMADA 4 - Monitor Persistente:
    - startPersistentControlMonitor(): Verifica DOM a cada 1.5s
    - For√ßa esconder qualquer controle que reapare√ßa
    - Ativo por 2 minutos ap√≥s in√≠cio da reprodu√ß√£o
    - Aplica√ß√£o de estilos com setProperty('important')
    
    üî∏ CAMADA 5 - Eventos do Clappr:
    - PLAYER_READY, PLAYER_PLAY, PLAYER_TIMEUPDATE
    - M√∫ltiplos timings: 1s, 2s, 3s, 4s, 5s
    - Fallback para casos sem eventos dispon√≠veis
    
    RESULTADO: Os controles do Clappr SER√ÉO escondidos definitivamente!
    ========================================

    ========================================
    üì± RESPONSIVIDADE APRIMORADA PARA MOBILE
    ========================================
    
    FUNCIONALIDADES IMPLEMENTADAS:
    
    üî∏ MOBILE LANDSCAPE (Tela Horizontal):
    - Player centralizado com margens de 30px nas laterais
    - Margens de 40px superior e inferior para isolamento
    - Container reduzido para 85% da largura (m√°x 600px)
    - Container reduzido para 70% da altura (m√°x 400px)
    - Controles fixos na parte inferior com design moderno
    - Sidebar compacta de 200px de largura
    - Borda e sombra destacadas para melhor visualiza√ß√£o
    - Overlay do canal com fundo semi-transparente
    
    üî∏ FULLSCREEN MOBILE (Autom√°tico para Vertical):
    - Detecta dispositivos m√≥veis automaticamente
    - For√ßa orienta√ß√£o portrait usando Screen Orientation API
    - Fallback com CSS transform caso API n√£o funcione
    - Rota√ß√£o de 90¬∞ via CSS se necess√°rio
    - Fullscreen nativo combinado com orienta√ß√£o for√ßada
    - Event listeners para mudan√ßas de orienta√ß√£o
    - Classes CSS espec√≠ficas para fullscreen mobile
    
    üî∏ BOT√ÉO INFO REMOVIDO:
    - Escondido em TODOS os dispositivos m√≥veis
    - Classe .info-btn para controle espec√≠fico
    - Funciona em portrait, landscape, touch devices
    - Mant√©m funcionalidade completa em desktop/TV
    
    üî∏ MELHORIAS VISUAIS:
    - Backdrop blur nos controles
    - Bordas com gradientes sutis
    - Espa√ßamento otimizado para touch
    - Transi√ß√µes suaves
    - Z-index otimizado para camadas
    
    COMPATIBILIDADE:
    ‚úÖ iOS Safari, Chrome Mobile, Samsung Internet
    ‚úÖ Android Chrome, Firefox Mobile
    ‚úÖ Todas as resolu√ß√µes mobile
    ‚úÖ Orienta√ß√£o autom√°tica
    ‚úÖ Touch e gestos nativos
    ========================================

    ========================================
    CONFIGURA√á√ÉO DA API DO YOUTUBE (OPCIONAL)
    ========================================
    
    Para ativar recursos avan√ßados do YouTube:
    - Detec√ß√£o autom√°tica de lives
    - Sistema de playlist/loop por canal
    - Reprodu√ß√£o autom√°tica de todos os v√≠deos do canal
    - Suporte a URLs de canal em todos os formatos
    
    1. Acesse: https://console.developers.google.com/
    2. Crie um novo projeto ou selecione um existente
    3. Ative a "YouTube Data API v3"
    4. Crie uma chave de API (API Key)
    5. Substitua "AIzaSyCNL4lsOgLRiRj1jc_5c0OVTK_E85ChVMc" na linha 169 pela sua chave
    
    FUNCIONALIDADES COM API CONFIGURADA:
    - Quando um canal YouTube estiver fazendo live, automaticamente 
      ser√° exibida a transmiss√£o ao vivo
    - Quando n√£o h√° live, ser√° reproduzido o √∫ltimo v√≠deo do canal
    - Ap√≥s o v√≠deo terminar, automaticamente reproduzir√° os outros 
      v√≠deos do canal, do mais recente ao mais antigo
    - Ap√≥s todos os v√≠deos, reinicia o loop infinitamente
    - Qualidade HD for√ßada em todos os v√≠deos
    - Auto-start do √∫ltimo canal assistido
    - Suporte completo a URLs de canal
    
    SEM API CONFIGURADA:
    - Os canais YouTube funcionam normalmente reproduzindo apenas
      o v√≠deo espec√≠fico da URL configurada (type: "youtube")
    - Canais type: "youtube_channel" mostrar√£o erro sem API
    - N√£o h√° sistema de playlist autom√°tica
    - N√£o h√° detec√ß√£o de lives
    
    TECLAS DE CONTROLE REMOTO:
    - Tela Cheia: F11, tecla ZOOM, tecla Aspect Ratio, Volume Down
    - Informa√ß√µes: INFO, ALT, HOME, F5
    - Todos os demais controles funcionam normalmente
    ========================================

    ========================================
    COMO TROCAR O SOM DA INTRO/SPLASH
    ========================================

    LINHA 168: Troque o arquivo de √°udio da splash screen

    LOCALIZA√á√ÉO:
    const SPLASH_SOUND_URL = 'https://roku-streaming-server.onrender.com/vinheta-plim-plim-hd.mp3';

    INSTRU√á√ïES:
    1. Substitua 'https://roku-streaming-server.onrender.com/vinheta-plim-plim-hd.mp3' pela URL ou caminho do seu arquivo
    2. Formatos suportados: MP3, WAV, OGG, AAC

    EXEMPLOS:
    - Arquivo local: './meu-som.mp3'
    - URL externa: 'https://meusite.com/som.mp3'  
    - Sem som: '' (deixe vazio para desativar)

    LINHA EXATA PARA ALTERAR:
    const SPLASH_SOUND_URL = 'SEU_ARQUIVO_DE_AUDIO_AQUI';

    NOTA: O arquivo deve estar na mesma pasta do HTML ou ser uma URL v√°lida
    ========================================
    -->

</body>
</html>